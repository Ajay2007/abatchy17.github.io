<div dir="ltr" style="text-align: left;" trbidi="on"><h2 style="text-align: left;">Bandit 16</h2><div style="text-align: left;">As indicated, we need to submit the current password to one of the ports between 31000 and 32000. For that we'll be using one of the greatest port scanning tools out there, <a href="https://nmap.org/">nmap</a>.</div><div style="text-align: left;"><i></i><br /></div><div style="text-align: left;">First, let's check which ports are open and which aren't. For a full list, run <b>nmap -h</b> or just <b>nmap</b> on your terminal. We'll also be using the <b>-sV</b> option to detect which service is listening on the open ports. </div><div style="text-align: left;"><br /></div><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> bandit16@melinda:~$ nmap -p 31000-32000 127.0.0.1  <br /> Starting Nmap 6.40 ( http://nmap.org ) at 2016-10-19 21:32 UTC  <br />Nmap scan report for localhost (127.0.0.1)<br />Host is up (0.00033s latency).<br />PORT      STATE SERVICE VERSION<br />31046/tcp open  echo<br />31518/tcp open  msdtc   Microsoft Distributed Transaction Coordinator (error)<br />31691/tcp open  echo<br />31790/tcp open  msdtc   Microsoft Distributed Transaction Coordinator (error)<br />31960/tcp open  echo<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Service detection performed. Please report any incorrect results at http://nmap.org/submit/ .<br />Nmap done: 1 IP address (1 host up) scanned in 41.18 seconds<br /></code></pre><div style="text-align: left;"><br /></div><div style="text-align: left;">Awesome, 3 ports don't interest us since they'll just echo your input. This leaves us port 31518 and 31790. We'll use <b>ncat </b>again to establish a secure connection.<br /><br /><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> bandit16@melinda:~$ <b>ncat --ssl -nv 127.0.0.1 31518</b>  <br /> Ncat: Version 6.40 ( http://nmap.org/ncat )  <br /> Ncat: SSL connection to 127.0.0.1:31518.  <br /> Ncat: SHA-1 fingerprint: 6872 7805 D7EC 03BA 51E2 B301 2651 8989 0556 7D66  <br /> cluFn7wTiGryunymYOu4RcffSxQluehd  <br /> cluFn7wTiGryunymYOu4RcffSxQluehd  <br /> ^C  <br /> bandit16@melinda:~$ <b>ncat --ssl -nv 127.0.0.1 31790</b>  <br /> Ncat: Version 6.40 ( http://nmap.org/ncat )  <br /> Ncat: SSL connection to 127.0.0.1:31790.  <br /> Ncat: SHA-1 fingerprint: 6872 7805 D7EC 03BA 51E2 B301 2651 8989 0556 7D66  <br /> cluFn7wTiGryunymYOu4RcffSxQluehd  <br /> Correct!  <br /> -----BEGIN RSA PRIVATE KEY-----  <br /> MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ  <br /> imZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ  <br /> Ja6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu  <br /> DSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW  <br /> JGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX  <br /> x0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD  <br /> KHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl  <br /> J9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd  <br /> d8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC  <br /> YNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A  <br /> vLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama  <br /> +TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT  <br /> 8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx  <br /> SatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd  <br /> HCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt  <br /> SghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A  <br /> R57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi  <br /> Ttiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg  <br /> R8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu  <br /> L8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni  <br /> blh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU  <br /> YOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM  <br /> 77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b  <br /> dxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3  <br /> vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY=  <br /> -----END RSA PRIVATE KEY-----  <br /> Thanks!  <br /> ^C  <br /> bandit16@melinda:~$  <br /></code></pre><br />31518 was just another echo service, submitting our password via port 31790 reveals another SSH private key. After logging as Bandit17, the password for it is xLYVMN9WE5zQ5vHacb0sZEVqbrp7nBTn.<br /><h2 style="text-align: left;">Bandit 17&nbsp;</h2><div style="text-align: left;">Quite straight forward, the diff command seems to be the sensible option. Let's check how to use it.&nbsp;</div><div style="text-align: left;"><br /></div><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> bandit17@melinda:~$ diff --help  <br /> Usage: diff [OPTION]... FILES  <br /> Compare FILES line by line.  <br /> Mandatory arguments to long options are mandatory for short options too.  <br />    --normal         output a normal diff (the default)&nbsp; <br />    ...</code></pre><div style="text-align: left;"><br />--normal is used by default, so "diff password.old password.new" should do it.<br /><br />Done! New password is the one on the right (kfBf3eYk5BPBRzwjqutbbfE887SVc5Yd)<br /><br /><h2 style="text-align: left;">Bandit 18</h2>Hmm, once you ssh into the server you just log out. We need to do 2 things:<br /><ul style="text-align: left;"><li>Figure out why we log out once connected.</li><li>Find a way to stay connected.</li></ul>Let's start by our first objective. You might've noticed that some hidden files exist in the home directory, like <b>.bashrc</b> or <b>.bash_profile</b>. We need to find a way to read their content. SSH is the only command we used, so let's check the help pages, maybe there's a way to run a command upon executing?<br /><br />ssh --help didn't reveal much info, let's try the man pages. -t looks promising.<br /><br /><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> abatchy@abatchy ~  <br /> $ <b>ssh bandit18@bandit.labs.overthewire.org -t "ls -al" </b> <br /> This is the OverTheWire game server. More information on http://www.overthewire.org/wargames  <br /> Please note that wargame usernames are no longer level&lt;X&gt;, but wargamename&lt;X&gt;  <br /> e.g. vortex4, semtex2, ...  <br /> Note: at this moment, blacksun is not available.  <br /> bandit18@bandit.labs.overthewire.org's password:  <br /> total 24  <br /> drwxr-xr-x  2 root   root   4096 Nov 14 2014 .  <br /> drwxr-xr-x 172 root   root   4096 Jul 10 14:12 ..  <br /> -rw-r--r--  1 root   root   220 Apr 9 2014 .bash_logout  <br /> -rw-r-----  1 bandit19 bandit18 3660 Nov 14 2014 .bashrc  <br /> -rw-r--r--  1 root   root   675 Apr 9 2014 .profile  <br /> -rw-r-----  1 bandit19 bandit18  33 Nov 14 2014 readme  <br /> Connection to bandit.labs.overthewire.org closed.  <br /> abatchy@abatchy ~  <br /> $ <b>ssh bandit18@bandit.labs.overthewire.org -t "cat readme"</b>  <br /> This is the OverTheWire game server. More information on http://www.overthewire.org/wargames  <br /> Please note that wargame usernames are no longer level&lt;X&gt;, but wargamename&lt;X&gt;  <br /> e.g. vortex4, semtex2, ...  <br /> Note: at this moment, blacksun is not available.  <br /> bandit18@bandit.labs.overthewire.org's password:  <br /><b> IueksS7Ubh8G3DCwVzrTd8rAVOwq3M5x  </b><br /> Connection to bandit.labs.overthewire.org closed.  <br /> abatchy@abatchy ~  <br /> $ ssh bandit18@bandit.labs.overthewire.org -t "sh"  <br /> This is the OverTheWire game server. More information on http://www.overthewire.org/wargames  <br /> Please note that wargame usernames are no longer level&lt;X&gt;, but wargamename&lt;X&gt;  <br /> e.g. vortex4, semtex2, ...  <br /> Note: at this moment, blacksun is not available.  <br /> bandit18@bandit.labs.overthewire.org's password:  <br /> $ ls  <br /> readme  <br /> $  <br /></code></pre><br />So basically, we have two solutions:<br /><br /><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"><b>ssh bandit18@bandit.labs.overthewire.org -t "ls -al"&nbsp;</b></code></pre><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"><b><code style="color: black; word-wrap: normal;"><b>ssh bandit18@bandit.labs.overthewire.org -t "cat readme" </b></code>&nbsp;</b></code></pre><br />or directly calling sh and have the regular interactive shell.<br /><h2 style="text-align: left;">Bandit 19</h2><div style="text-align: left;">In this challenge, we'll get introduced to a new term, which is <a href="https://en.wikipedia.org/wiki/Setuid">setuid</a>. Any file/directory in Unix has read, write, execute (if not directory) permissions for owner, group or other. You can read more about permissions <a href="https://www.tutorialspoint.com/unix/unix-file-permission.htm">here</a>.</div><div style="text-align: left;"><br /></div><div style="text-align: left;">A misconfigured setuid program could be disastrous as it could give a limited account root access. <a href="https://www.root-me.org/en/Challenges/App-Script">Root-me.org</a> has a few great examples on how to exploit it. Another interesting read is <a href="https://gist.github.com/dergachev/7916152">nmap's interactive mode</a>.</div><div style="text-align: left;"><br /></div><div style="text-align: left;">Alright, let's see what's the setuid program does.</div><div style="text-align: left;"><br /></div><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> bandit19@melinda:~$ <b>ls -al</b>  <br /> total 28  <br /> drwxr-xr-x  2 root   root   4096 Nov 14 2014 .  <br /> drwxr-xr-x 172 root   root   4096 Jul 10 14:12 ..  <br /> -rw-r--r--  1 root   root   220 Apr 9 2014 .bash_logout  <br /> -rw-r--r--  1 root   root   3637 Apr 9 2014 .bashrc  <br /> -rw-r--r--  1 root   root   675 Apr 9 2014 .profile  <br /> -rw<b>s</b>r-x---  1 bandit20 bandit19 7370 Nov 14 2014 bandit20-do  <br /> bandit19@melinda:~$ ./bandit20-do  <br /> Run a command as another user.  <br />  Example: ./bandit20-do id&nbsp;</code></pre><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;">&nbsp;bandit19@melinda:~$ <b>./bandit20-do "whoami"</b>  <br /> bandit20&nbsp;</code></pre><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;">&nbsp;bandit19@melinda:~$ <b>./bandit20-do cat /etc/bandit_pass/bandit20</b>  <br /> GbKksEFF4yrVs6il55v6gwY5aVje5f0j  <br /> bandit19@melinda:~$  <br /></code></pre><div style="text-align: left;"><br /><h2 style="text-align: left;">Bandit 20</h2><div style="text-align: left;">Hmm, so the setuid will be acting as the service listening to the port we specify, we'll fire up another terminal to make it act as the host. What are we waiting for?</div><div style="text-align: left;"></div><h4 style="text-align: left;">Terminal 1 (host):</h4><h4 style="text-align: left;"><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> <span style="font-weight: normal;">bandit20@melinda:~$ nc -nvlp 44444</span>  <br /> <span style="font-weight: normal;">Listening on [0.0.0.0] (family 0, port 44444)</span>  <br /></code></pre><br />Terminal 2 (client):</h4><h4 style="text-align: left;"></h4><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> bandit20@melinda:~$ ls  <br /> suconnect  <br /> bandit20@melinda:~$ ./suconnect  <br /> Usage: ./suconnect &lt;portnumber&gt;  <br /> This program will connect to the given port on localhost using TCP. If it receives the correct password from the other side, the next password is transmitted back.  <br /> bandit20@melinda:~$ ./suconnect 4444  <br /> ERROR: Can't connect  <br /> bandit20@melinda:~$ ./suconnect 44444  <br /> ERROR: Can't connect  <br /> bandit20@melinda:~$ ./suconnect 44444  <br /> Read: GbKksEFF4yrVs6il55v6gwY5aVje5f0j  <br /> Password matches, sending next password  <br /></code></pre><h4 style="text-align: left;">Terminal 1 (server):</h4><pre style="background: #f0f0f0; border: 1px dashed #cccccc; color: black; font-family: &quot;arial&quot;; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;"> bandit20@melinda:~$ nc -nvlp 44444  <br /> Listening on [0.0.0.0] (family 0, port 44444)  <br /> Connection from [127.0.0.1] port 44444 [tcp/*] accepted (family 2, sport 33272)  <br /> GbKksEFF4yrVs6il55v6gwY5aVje5f0j  <br /> gE269g2h3mw3pwgrj0Ha9Uoqen1c9DGr  <br /></code></pre><h4 style="text-align: left;"></h4><div style="text-align: left;">Done. To sum it up:<br /><ol style="text-align: left;"><li>On terminal 1 (host), start netcat as server: <b>nc -nvlp 44444</b></li><li>On terminal 2 (client/setuid), run suconnect on same port: <b>./suconnect 44444</b></li><li>Back to terminal 1, send the password of current level.</li><li>Suconnect will show you the password.<b> </b></li></ol></div></div></div></div></div>